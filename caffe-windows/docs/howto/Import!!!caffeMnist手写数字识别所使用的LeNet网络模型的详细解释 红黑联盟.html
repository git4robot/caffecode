<html xmlns="http://www.w3.org/1999/xhtml">
<head><meta http-equiv="Content-Type" content="text/html; charset=GBK">

<link rel="stylesheet" href="./important_caffe/article.css" type="text/css">
<title>caffeMnist手写数字识别所使用的LeNet网络模型的详细解释-红黑联盟</title>
<meta name="description" content="CNN神经网络模型的概述: 在我没有学习卷积神经网络(深度学习)之前,我看了很多的神经网络,什么人工神经网络,BP神经网络等等,在学习神经网络的时候,经常会见到下面的网络模型或者说图片吧。">
<link type="text/css" rel="stylesheet" href="./important_caffe/shCore.css">
<link type="text/css" rel="stylesheet" href="./important_caffe/shThemeDefault.css">

</head>

<body>
<div class="divline8"></div>
<div class="it165_box">
	<div class="box_left">
            
		<dl class="box_t"><dd>caffe自带的第一个例子,Mnist手写数字识别所使用的LeNet网络模型的详细解释</dd></dl>
		<dl class="box_body" id="fontzoom"><dd id="Article">
        <div><div id="highlighter_595069" class="syntaxhighlighter  java"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="java plain">(一)CNN神经网络模型的概述:</code></div><div class="line number2 index1 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;</code><code class="java plain">在我没有学习卷积神经网络(深度学习)之前,我看了很多的神经网络,什么人工神经网络,BP神经网络等等,在学习</code></div><div class="line number3 index2 alt2"><code class="java plain">神经网络的时候,经常会见到下面的网络模型或者说图片吧:</code></div></div></td></tr></tbody></table></div></div>
<p><img alt="\" src="./important_caffe/20161101092038625.jpg" style="width: 317px; height: 256px;"><img alt="\" src="./important_caffe/20161101092038626.jpg" style="width: 389px; height: 205px;"></p>
<div><div id="highlighter_656918" class="syntaxhighlighter  java"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="java plain">那么问题来了,如果我们要用程序来实现这些神经网络的话,使用什么样的形式去实现它呢?</code></div><div class="line number2 index1 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java value">1</code><code class="java plain">---结构体+结构体指针</code></div><div class="line number3 index2 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java value">2</code><code class="java plain">---类</code></div><div class="line number4 index3 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;</code><code class="java plain">总之,是一个比较困难的事情.现在caffe为我们提供了一种很方便的方法:使用网络配置文件去实现它,如果拿Mnist</code></div><div class="line number5 index4 alt2"><code class="java plain">手写数字识别所使用的CNN神经网络模型LeNet来说的话,它的神经网络模型的描述文件就是/home/wei/caffe/examples</code></div><div class="line number6 index5 alt1"><code class="java plain">/mnist/文件夹下面的:lenet_train_test.prototxt</code></div><div class="line number7 index6 alt2"><code class="java plain">(二)LeNet模型的详解</code></div><div class="line number8 index7 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;</code><code class="java plain">在我们具体看这个网络模型描述文件之前,我们首先使用caffe的可视化程序,将这个网络模型画出来.我们使用/home</code></div><div class="line number9 index8 alt2"><code class="java plain">/wei/caffe/python/文件夹下的draw_net.py这个python脚本程序.</code></div><div class="line number10 index9 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;</code><code class="java plain">具体的命令如下所示:</code></div></div></td></tr></tbody></table></div></div>
<img alt="\" src="./important_caffe/20161101092039627.png" style="width: 630px; height: 354.375px;">
<div><div id="highlighter_858860" class="syntaxhighlighter  java"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="java plain">sudo python ./python/draw_net.py&nbsp; ./examples/mnist/lenet_train_test.prototxt&nbsp; ./examples/mnist/lenet_train_test.jpeg</code></div></div></td></tr></tbody></table></div></div>
<p><img alt="\" src="./important_caffe/20161101092039628.jpg" style="height: 560px; width: 420px;"></p>
<p><img alt="\" src="./important_caffe/20161101092039631.png" style="width: 630px; height: 354.375px;"></p>
<p>结合上面我画的LeNat-CNN模型的网络结构图,然后去看网络描述(配置文件),试着理解LeNet模型(最简单的卷积神经网络模型):</p>
<p>那么,现在,我们来具体看一下lenet_train_test.prototxt这个文件的具体内容:</p>
<div><div id="highlighter_681431" class="syntaxhighlighter  java"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div><div class="line number40 index39 alt1">40</div><div class="line number41 index40 alt2">41</div><div class="line number42 index41 alt1">42</div><div class="line number43 index42 alt2">43</div><div class="line number44 index43 alt1">44</div><div class="line number45 index44 alt2">45</div><div class="line number46 index45 alt1">46</div><div class="line number47 index46 alt2">47</div><div class="line number48 index47 alt1">48</div><div class="line number49 index48 alt2">49</div><div class="line number50 index49 alt1">50</div><div class="line number51 index50 alt2">51</div><div class="line number52 index51 alt1">52</div><div class="line number53 index52 alt2">53</div><div class="line number54 index53 alt1">54</div><div class="line number55 index54 alt2">55</div><div class="line number56 index55 alt1">56</div><div class="line number57 index56 alt2">57</div><div class="line number58 index57 alt1">58</div><div class="line number59 index58 alt2">59</div><div class="line number60 index59 alt1">60</div><div class="line number61 index60 alt2">61</div><div class="line number62 index61 alt1">62</div><div class="line number63 index62 alt2">63</div><div class="line number64 index63 alt1">64</div><div class="line number65 index64 alt2">65</div><div class="line number66 index65 alt1">66</div><div class="line number67 index66 alt2">67</div><div class="line number68 index67 alt1">68</div><div class="line number69 index68 alt2">69</div><div class="line number70 index69 alt1">70</div><div class="line number71 index70 alt2">71</div><div class="line number72 index71 alt1">72</div><div class="line number73 index72 alt2">73</div><div class="line number74 index73 alt1">74</div><div class="line number75 index74 alt2">75</div><div class="line number76 index75 alt1">76</div><div class="line number77 index76 alt2">77</div><div class="line number78 index77 alt1">78</div><div class="line number79 index78 alt2">79</div><div class="line number80 index79 alt1">80</div><div class="line number81 index80 alt2">81</div><div class="line number82 index81 alt1">82</div><div class="line number83 index82 alt2">83</div><div class="line number84 index83 alt1">84</div><div class="line number85 index84 alt2">85</div><div class="line number86 index85 alt1">86</div><div class="line number87 index86 alt2">87</div><div class="line number88 index87 alt1">88</div><div class="line number89 index88 alt2">89</div><div class="line number90 index89 alt1">90</div><div class="line number91 index90 alt2">91</div><div class="line number92 index91 alt1">92</div><div class="line number93 index92 alt2">93</div><div class="line number94 index93 alt1">94</div><div class="line number95 index94 alt2">95</div><div class="line number96 index95 alt1">96</div><div class="line number97 index96 alt2">97</div><div class="line number98 index97 alt1">98</div><div class="line number99 index98 alt2">99</div><div class="line number100 index99 alt1">100</div><div class="line number101 index100 alt2">101</div><div class="line number102 index101 alt1">102</div><div class="line number103 index102 alt2">103</div><div class="line number104 index103 alt1">104</div><div class="line number105 index104 alt2">105</div><div class="line number106 index105 alt1">106</div><div class="line number107 index106 alt2">107</div><div class="line number108 index107 alt1">108</div><div class="line number109 index108 alt2">109</div><div class="line number110 index109 alt1">110</div><div class="line number111 index110 alt2">111</div><div class="line number112 index111 alt1">112</div><div class="line number113 index112 alt2">113</div><div class="line number114 index113 alt1">114</div><div class="line number115 index114 alt2">115</div><div class="line number116 index115 alt1">116</div><div class="line number117 index116 alt2">117</div><div class="line number118 index117 alt1">118</div><div class="line number119 index118 alt2">119</div><div class="line number120 index119 alt1">120</div><div class="line number121 index120 alt2">121</div><div class="line number122 index121 alt1">122</div><div class="line number123 index122 alt2">123</div><div class="line number124 index123 alt1">124</div><div class="line number125 index124 alt2">125</div><div class="line number126 index125 alt1">126</div><div class="line number127 index126 alt2">127</div><div class="line number128 index127 alt1">128</div><div class="line number129 index128 alt2">129</div><div class="line number130 index129 alt1">130</div><div class="line number131 index130 alt2">131</div><div class="line number132 index131 alt1">132</div><div class="line number133 index132 alt2">133</div><div class="line number134 index133 alt1">134</div><div class="line number135 index134 alt2">135</div><div class="line number136 index135 alt1">136</div><div class="line number137 index136 alt2">137</div><div class="line number138 index137 alt1">138</div><div class="line number139 index138 alt2">139</div><div class="line number140 index139 alt1">140</div><div class="line number141 index140 alt2">141</div><div class="line number142 index141 alt1">142</div><div class="line number143 index142 alt2">143</div><div class="line number144 index143 alt1">144</div><div class="line number145 index144 alt2">145</div><div class="line number146 index145 alt1">146</div><div class="line number147 index146 alt2">147</div><div class="line number148 index147 alt1">148</div><div class="line number149 index148 alt2">149</div><div class="line number150 index149 alt1">150</div><div class="line number151 index150 alt2">151</div><div class="line number152 index151 alt1">152</div><div class="line number153 index152 alt2">153</div><div class="line number154 index153 alt1">154</div><div class="line number155 index154 alt2">155</div><div class="line number156 index155 alt1">156</div><div class="line number157 index156 alt2">157</div><div class="line number158 index157 alt1">158</div><div class="line number159 index158 alt2">159</div><div class="line number160 index159 alt1">160</div><div class="line number161 index160 alt2">161</div><div class="line number162 index161 alt1">162</div><div class="line number163 index162 alt2">163</div><div class="line number164 index163 alt1">164</div><div class="line number165 index164 alt2">165</div><div class="line number166 index165 alt1">166</div><div class="line number167 index166 alt2">167</div><div class="line number168 index167 alt1">168</div><div class="line number169 index168 alt2">169</div><div class="line number170 index169 alt1">170</div><div class="line number171 index170 alt2">171</div><div class="line number172 index171 alt1">172</div><div class="line number173 index172 alt2">173</div><div class="line number174 index173 alt1">174</div><div class="line number175 index174 alt2">175</div><div class="line number176 index175 alt1">176</div><div class="line number177 index176 alt2">177</div><div class="line number178 index177 alt1">178</div><div class="line number179 index178 alt2">179</div><div class="line number180 index179 alt1">180</div><div class="line number181 index180 alt2">181</div><div class="line number182 index181 alt1">182</div><div class="line number183 index182 alt2">183</div><div class="line number184 index183 alt1">184</div><div class="line number185 index184 alt2">185</div><div class="line number186 index185 alt1">186</div><div class="line number187 index186 alt2">187</div><div class="line number188 index187 alt1">188</div><div class="line number189 index188 alt2">189</div><div class="line number190 index189 alt1">190</div><div class="line number191 index190 alt2">191</div><div class="line number192 index191 alt1">192</div><div class="line number193 index192 alt2">193</div><div class="line number194 index193 alt1">194</div><div class="line number195 index194 alt2">195</div><div class="line number196 index195 alt1">196</div><div class="line number197 index196 alt2">197</div><div class="line number198 index197 alt1">198</div><div class="line number199 index198 alt2">199</div><div class="line number200 index199 alt1">200</div><div class="line number201 index200 alt2">201</div><div class="line number202 index201 alt1">202</div><div class="line number203 index202 alt2">203</div><div class="line number204 index203 alt1">204</div><div class="line number205 index204 alt2">205</div><div class="line number206 index205 alt1">206</div><div class="line number207 index206 alt2">207</div><div class="line number208 index207 alt1">208</div><div class="line number209 index208 alt2">209</div><div class="line number210 index209 alt1">210</div><div class="line number211 index210 alt2">211</div><div class="line number212 index211 alt1">212</div><div class="line number213 index212 alt2">213</div><div class="line number214 index213 alt1">214</div><div class="line number215 index214 alt2">215</div><div class="line number216 index215 alt1">216</div><div class="line number217 index216 alt2">217</div><div class="line number218 index217 alt1">218</div><div class="line number219 index218 alt2">219</div><div class="line number220 index219 alt1">220</div><div class="line number221 index220 alt2">221</div><div class="line number222 index221 alt1">222</div><div class="line number223 index222 alt2">223</div><div class="line number224 index223 alt1">224</div><div class="line number225 index224 alt2">225</div><div class="line number226 index225 alt1">226</div><div class="line number227 index226 alt2">227</div><div class="line number228 index227 alt1">228</div><div class="line number229 index228 alt2">229</div><div class="line number230 index229 alt1">230</div><div class="line number231 index230 alt2">231</div><div class="line number232 index231 alt1">232</div><div class="line number233 index232 alt2">233</div><div class="line number234 index233 alt1">234</div><div class="line number235 index234 alt2">235</div><div class="line number236 index235 alt1">236</div><div class="line number237 index236 alt2">237</div><div class="line number238 index237 alt1">238</div><div class="line number239 index238 alt2">239</div><div class="line number240 index239 alt1">240</div><div class="line number241 index240 alt2">241</div><div class="line number242 index241 alt1">242</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="java comments">//***********************************************************************************************</code></div><div class="line number2 index1 alt1"><code class="java plain">name: </code><code class="java string">"LeNet"</code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code class="java comments">//[1]网络(Net)的名称为:LeNet</code></div><div class="line number3 index2 alt2"><code class="java plain">/***********************************************************************************************</code></div><div class="line number4 index3 alt1"><code class="java plain">*模块</code><code class="java value">1</code><code class="java plain">:</code></div><div class="line number5 index4 alt2"><code class="java plain">*&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="java value">1</code><code class="java plain">--数据层----Data Layer</code></div><div class="line number6 index5 alt1"><code class="java plain">*&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="java value">2</code><code class="java plain">--该数据层只在[训练]阶段有效</code></div><div class="line number7 index6 alt2"><code class="java plain">***********************************************************************************************/</code></div><div class="line number8 index7 alt1"><code class="java plain">layer {&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="java preprocessor">/****[1]定义一个数据层****/</code></div><div class="line number9 index8 alt2"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">name: </code><code class="java string">"mnist"</code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code class="java comments">//[1]数据层的名字为--mnist</code></div><div class="line number10 index9 alt1"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">type: </code><code class="java string">"Data"</code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code class="java comments">//[2]层的层类型:Data(数据层)(数据库作为输入)</code></div><div class="line number11 index10 alt2"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">top: </code><code class="java string">"data"</code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code class="java comments">//[3]数据层的输出blob有两个:data,label(对应生成的CNN图看)</code></div><div class="line number12 index11 alt1"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">top: </code><code class="java string">"label"</code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div><div class="line number13 index12 alt2"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">include {&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="java comments">//[4]include里面的数据说明,该层只在训练阶段有效</code></div><div class="line number14 index13 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">phase: TRAIN</code></div><div class="line number15 index14 alt2"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number16 index15 alt1"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">transform_param {&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="java comments">//[5]数据预处理,转换参数的定义</code></div><div class="line number17 index16 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">scale: </code><code class="java value">0.00390625</code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code class="java comments">//[5]特征归一化系数,将范围为[0,255]的MNIST数据归一化为[0,1]</code></div><div class="line number18 index17 alt1"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number19 index18 alt2"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">data_param {&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="java comments">//[6]数据层的参数</code></div><div class="line number20 index19 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">source: </code><code class="java string">"examples/mnist/mnist_train_lmdb"</code><code class="java comments">//[1]由于该数据层的数据来源是数据库(由层类型Data指定),</code></div><div class="line number21 index20 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments">//&nbsp;&nbsp; 因此,source对应的就是数据库LMDB的路径,也就是训练</code></div><div class="line number22 index21 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments">//&nbsp;&nbsp; 数据和测试数据的path</code></div><div class="line number23 index22 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">batch_size: </code><code class="java value">64</code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code class="java comments">//[2]批量数目,表示caffe一次从数据库LMDB读入的图片的数量</code></div><div class="line number24 index23 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">backend: LMDB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="java comments">//[3]数据库的类型说明区别于LevelDB数据库</code></div><div class="line number25 index24 alt2"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number26 index25 alt1"><code class="java plain">}</code></div><div class="line number27 index26 alt2"><code class="java preprocessor">/***********************************************************************************************</code></div><div class="line number28 index27 alt1"><code class="java preprocessor">*模块2:</code></div><div class="line number29 index28 alt2"><code class="java preprocessor">*&nbsp;&nbsp;&nbsp;&nbsp; 1--数据层----Data Layer</code></div><div class="line number30 index29 alt1"><code class="java preprocessor">*&nbsp;&nbsp;&nbsp;&nbsp; 2--一个新的数据层,名字也叫做mnist,输出的blob也是data和label,但是这个数据层只在分类阶段有效,Test</code></div><div class="line number31 index30 alt2"><code class="java preprocessor">*&nbsp;&nbsp;&nbsp;&nbsp; 3--图片大小28*28</code></div><div class="line number32 index31 alt1"><code class="java preprocessor">***********************************************************************************************/</code></div><div class="line number33 index32 alt2"><code class="java plain">layer {</code></div><div class="line number34 index33 alt1"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">name: </code><code class="java string">"mnist"</code></div><div class="line number35 index34 alt2"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">type: </code><code class="java string">"Data"</code></div><div class="line number36 index35 alt1"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">top: </code><code class="java string">"data"</code></div><div class="line number37 index36 alt2"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">top: </code><code class="java string">"label"</code></div><div class="line number38 index37 alt1"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">include {</code></div><div class="line number39 index38 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">phase: TEST</code></div><div class="line number40 index39 alt1"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number41 index40 alt2"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">transform_param {</code></div><div class="line number42 index41 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">scale: </code><code class="java value">0.00390625</code></div><div class="line number43 index42 alt2"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number44 index43 alt1"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">data_param {</code></div><div class="line number45 index44 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">source: </code><code class="java string">"examples/mnist/mnist_test_lmdb"</code></div><div class="line number46 index45 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">batch_size: </code><code class="java value">100</code></div><div class="line number47 index46 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">backend: LMDB</code></div><div class="line number48 index47 alt1"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number49 index48 alt2"><code class="java plain">}</code></div><div class="line number50 index49 alt1"><code class="java preprocessor">/***********************************************************************************************</code></div><div class="line number51 index50 alt2"><code class="java preprocessor">*模块3:</code></div><div class="line number52 index51 alt1"><code class="java preprocessor">*&nbsp;&nbsp;&nbsp;&nbsp; 1--第一个卷积层---Convolution</code></div><div class="line number53 index52 alt2"><code class="java preprocessor">*&nbsp;&nbsp;&nbsp;&nbsp; 2--定义一个新的卷积层,卷积层的输入blob为data;输出blob为conv1</code></div><div class="line number54 index53 alt1"><code class="java preprocessor">*&nbsp;&nbsp;&nbsp;&nbsp; 3--Convolution层,使用一系列可训练的卷积核(相当于空间滤波的滤波算子)对输入图像进行卷积操作,每组</code></div><div class="line number55 index54 alt2"><code class="java preprocessor">*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 卷积核生成输出图像中的一个特征图(相当于对输入图像,使用20个不同的滤波算子(卷积)进行20次卷积</code></div><div class="line number56 index55 alt1"><code class="java preprocessor">*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 之后生成的20张经过滤波的特征图)</code></div><div class="line number57 index56 alt2"><code class="java preprocessor">*&nbsp;&nbsp;&nbsp;&nbsp; 4--输出图片大小:(28+2*0-5)/1+1=(img_h+2*pad_h-kernel_h)/stride_h+1======24*24</code></div><div class="line number58 index57 alt1"><code class="java preprocessor">***********************************************************************************************/</code></div><div class="line number59 index58 alt2"><code class="java plain">layer {</code></div><div class="line number60 index59 alt1"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">name: </code><code class="java string">"conv1"</code></div><div class="line number61 index60 alt2"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">type: </code><code class="java string">"Convolution"</code></div><div class="line number62 index61 alt1"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">bottom: </code><code class="java string">"data"</code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code class="java comments">//[1]卷积层的输入blob为data</code></div><div class="line number63 index62 alt2"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">top: </code><code class="java string">"conv1"</code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code class="java comments">//[2]卷积层的输出blob为conv1</code></div><div class="line number64 index63 alt1"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">param {&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="java comments">//[3]卷积层的:权值学习速率倍乘因子,1表示,保持与全局参数一致</code></div><div class="line number65 index64 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">lr_mult: </code><code class="java value">1</code></div><div class="line number66 index65 alt1"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number67 index66 alt2"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">param {&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="java comments">//[4]卷积层的:偏置项的学习速率倍乘因子,是全局参数的2倍</code></div><div class="line number68 index67 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">lr_mult: </code><code class="java value">2</code></div><div class="line number69 index68 alt2"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number70 index69 alt1"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">convolution_param {&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="java comments">//[5]卷积层的计算参数</code></div><div class="line number71 index70 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">num_output: </code><code class="java value">20</code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code class="java comments">//[1]输出feature map的数目为20,对应的也就是卷积核的数量</code></div><div class="line number72 index71 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">kernel_size: </code><code class="java value">5</code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code class="java comments">//[2]卷积核的尺寸为:5*5</code></div><div class="line number73 index72 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">stride: </code><code class="java value">1</code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code class="java comments">//[3]卷积核在输入图片上滑动的步长为:1</code></div><div class="line number74 index73 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">weight_filler {&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="java comments">//[6]指定权值的初始化方案为:xavier</code></div><div class="line number75 index74 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">type: </code><code class="java string">"xavier"</code></div><div class="line number76 index75 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number77 index76 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">bias_filler {&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="java comments">//[7]偏执项的初始化方案为:constant,默认为0</code></div><div class="line number78 index77 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">type: </code><code class="java string">"constant"</code></div><div class="line number79 index78 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number80 index79 alt1"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number81 index80 alt2"><code class="java plain">}</code></div><div class="line number82 index81 alt1"><code class="java preprocessor">/***********************************************************************************************</code></div><div class="line number83 index82 alt2"><code class="java preprocessor">*模块4:</code></div><div class="line number84 index83 alt1"><code class="java preprocessor">*&nbsp;&nbsp;&nbsp;&nbsp; 1--第一个池化层---pool1</code></div><div class="line number85 index84 alt2"><code class="java preprocessor">*&nbsp;&nbsp;&nbsp;&nbsp; 2--定义一个下采样层(池化层),这个池化层的输入blob为conv1,输出blob为pool1</code></div><div class="line number86 index85 alt1"><code class="java preprocessor">*&nbsp;&nbsp;&nbsp;&nbsp; 3--输出图片的大小===12*12</code></div><div class="line number87 index86 alt2"><code class="java preprocessor">***********************************************************************************************/</code></div><div class="line number88 index87 alt1"><code class="java plain">layer {</code></div><div class="line number89 index88 alt2"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">name: </code><code class="java string">"pool1"</code></div><div class="line number90 index89 alt1"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">type: </code><code class="java string">"Pooling"</code></div><div class="line number91 index90 alt2"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">bottom: </code><code class="java string">"conv1"</code></div><div class="line number92 index91 alt1"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">top: </code><code class="java string">"pool1"</code></div><div class="line number93 index92 alt2"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">pooling_param {&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="java comments">//[1]池化层(下采样)的参数</code></div><div class="line number94 index93 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">pool: MAX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="java comments">//[1]目前提供了三种池化的方法:最大值池化,均值池化,随机池化</code></div><div class="line number95 index94 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments">//&nbsp;&nbsp;&nbsp; 很明显,该池化层使用了最大值池化MAX</code></div><div class="line number96 index95 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">kernel_size: </code><code class="java value">2</code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code class="java comments">//[2]指定池化窗口的宽度和高度:2*2</code></div><div class="line number97 index96 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">stride: </code><code class="java value">2</code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code class="java comments">//[3]指定池化窗口在输入数据上滑动的步长为:2</code></div><div class="line number98 index97 alt1"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number99 index98 alt2"><code class="java plain">}</code></div><div class="line number100 index99 alt1"><code class="java preprocessor">/***********************************************************************************************</code></div><div class="line number101 index100 alt2"><code class="java preprocessor">*模块5:</code></div><div class="line number102 index101 alt1"><code class="java preprocessor">*&nbsp;&nbsp;&nbsp;&nbsp; 1--第二个卷积层:conv2</code></div><div class="line number103 index102 alt2"><code class="java preprocessor">*&nbsp;&nbsp;&nbsp;&nbsp; 2--该卷积层的输入blob为pool1,输出blob为conv2</code></div><div class="line number104 index103 alt1"><code class="java preprocessor">*&nbsp;&nbsp;&nbsp;&nbsp; 3--注意:该卷积层输出的feature map(特征图的数量)为:50</code></div><div class="line number105 index104 alt2"><code class="java preprocessor">*&nbsp;&nbsp;&nbsp;&nbsp; 4--输出图片的大小为:(12-2*0-5)/1+1=======8*8</code></div><div class="line number106 index105 alt1"><code class="java preprocessor">***********************************************************************************************/</code></div><div class="line number107 index106 alt2"><code class="java plain">layer {</code></div><div class="line number108 index107 alt1"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">name: </code><code class="java string">"conv2"</code></div><div class="line number109 index108 alt2"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">type: </code><code class="java string">"Convolution"</code></div><div class="line number110 index109 alt1"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">bottom: </code><code class="java string">"pool1"</code></div><div class="line number111 index110 alt2"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">top: </code><code class="java string">"conv2"</code></div><div class="line number112 index111 alt1"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">param {</code></div><div class="line number113 index112 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">lr_mult: </code><code class="java value">1</code></div><div class="line number114 index113 alt1"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number115 index114 alt2"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">param {</code></div><div class="line number116 index115 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">lr_mult: </code><code class="java value">2</code></div><div class="line number117 index116 alt2"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number118 index117 alt1"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">convolution_param {</code></div><div class="line number119 index118 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">num_output: </code><code class="java value">50</code></div><div class="line number120 index119 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">kernel_size: </code><code class="java value">5</code></div><div class="line number121 index120 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">stride: </code><code class="java value">1</code></div><div class="line number122 index121 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">weight_filler {</code></div><div class="line number123 index122 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">type: </code><code class="java string">"xavier"</code></div><div class="line number124 index123 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number125 index124 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">bias_filler {</code></div><div class="line number126 index125 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">type: </code><code class="java string">"constant"</code></div><div class="line number127 index126 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number128 index127 alt1"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number129 index128 alt2"><code class="java plain">}</code></div><div class="line number130 index129 alt1"><code class="java preprocessor">/***********************************************************************************************</code></div><div class="line number131 index130 alt2"><code class="java preprocessor">*模块6:</code></div><div class="line number132 index131 alt1"><code class="java preprocessor">*&nbsp;&nbsp;&nbsp;&nbsp; 1--第二个池化层:pool2</code></div><div class="line number133 index132 alt2"><code class="java preprocessor">*&nbsp;&nbsp;&nbsp;&nbsp; 2--该池化层的输入blob为conv2,输出blob为pool2</code></div><div class="line number134 index133 alt1"><code class="java preprocessor">***********************************************************************************************/</code></div><div class="line number135 index134 alt2"><code class="java plain">layer {</code></div><div class="line number136 index135 alt1"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">name: </code><code class="java string">"pool2"</code></div><div class="line number137 index136 alt2"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">type: </code><code class="java string">"Pooling"</code></div><div class="line number138 index137 alt1"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">bottom: </code><code class="java string">"conv2"</code></div><div class="line number139 index138 alt2"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">top: </code><code class="java string">"pool2"</code></div><div class="line number140 index139 alt1"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">pooling_param {</code></div><div class="line number141 index140 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">pool: MAX</code></div><div class="line number142 index141 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">kernel_size: </code><code class="java value">2</code></div><div class="line number143 index142 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">stride: </code><code class="java value">2</code></div><div class="line number144 index143 alt1"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number145 index144 alt2"><code class="java plain">}</code></div><div class="line number146 index145 alt1"><code class="java preprocessor">/***********************************************************************************************</code></div><div class="line number147 index146 alt2"><code class="java preprocessor">*模块7:</code></div><div class="line number148 index147 alt1"><code class="java preprocessor">*&nbsp;&nbsp;&nbsp;&nbsp; 1--第一个全连接层</code></div><div class="line number149 index148 alt2"><code class="java preprocessor">*&nbsp;&nbsp;&nbsp;&nbsp; 2--该层的输入blob为:pool2,输出blob为iP1</code></div><div class="line number150 index149 alt1"><code class="java preprocessor">*&nbsp;&nbsp;&nbsp;&nbsp; 3--注意:全连接层的的输出节点数(num_output==500)可以理解为滤波器的个数(滤波算子的个数),对应的也</code></div><div class="line number151 index150 alt2"><code class="java preprocessor">*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 就是输出特征图的个数</code></div><div class="line number152 index151 alt1"><code class="java preprocessor">***********************************************************************************************/</code></div><div class="line number153 index152 alt2"><code class="java plain">layer {</code></div><div class="line number154 index153 alt1"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">name: </code><code class="java string">"ip1"</code></div><div class="line number155 index154 alt2"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">type: </code><code class="java string">"InnerProduct"</code></div><div class="line number156 index155 alt1"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">bottom: </code><code class="java string">"pool2"</code></div><div class="line number157 index156 alt2"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">top: </code><code class="java string">"ip1"</code></div><div class="line number158 index157 alt1"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">param {</code></div><div class="line number159 index158 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">lr_mult: </code><code class="java value">1</code></div><div class="line number160 index159 alt1"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number161 index160 alt2"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">param {</code></div><div class="line number162 index161 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">lr_mult: </code><code class="java value">2</code></div><div class="line number163 index162 alt2"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number164 index163 alt1"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">inner_product_param {&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="java comments">//[1]全连接层的参数:</code></div><div class="line number165 index164 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">num_output: </code><code class="java value">500</code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code class="java comments">//[1]该层的输出元素的个数为:500</code></div><div class="line number166 index165 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">weight_filler {&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="java comments">//[2]指定全连接层的初始化方案:xavier</code></div><div class="line number167 index166 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">type: </code><code class="java string">"xavier"</code></div><div class="line number168 index167 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number169 index168 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">bias_filler {</code></div><div class="line number170 index169 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">type: </code><code class="java string">"constant"</code></div><div class="line number171 index170 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number172 index171 alt1"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number173 index172 alt2"><code class="java plain">}</code></div><div class="line number174 index173 alt1"><code class="java preprocessor">/***********************************************************************************************</code></div><div class="line number175 index174 alt2"><code class="java preprocessor">*模块8:</code></div><div class="line number176 index175 alt1"><code class="java preprocessor">*&nbsp;&nbsp;&nbsp;&nbsp; 1--新的非线性层(激活函数)(规整化线性单元),此激活层采用的激活函数为:RELU</code></div><div class="line number177 index176 alt2"><code class="java preprocessor">*&nbsp;&nbsp;&nbsp;&nbsp; 2--该激活层的输入blob为iP1,输出blob也为iP1</code></div><div class="line number178 index177 alt1"><code class="java preprocessor">*&nbsp;&nbsp;&nbsp;&nbsp; 3--该(规整化线性单元)激活层的作用为:对全连接层的每一个输出数据进行判断,当x&gt;0时,RELU的输出为x,</code></div><div class="line number179 index178 alt2"><code class="java preprocessor">*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 根据X的大小,说明这个单元的激活程度(兴奋程度);如果x&lt;=0,则这个信号(特征图)被完全抑制</code></div><div class="line number180 index179 alt1"><code class="java preprocessor">***********************************************************************************************/</code></div><div class="line number181 index180 alt2"><code class="java plain">layer {</code></div><div class="line number182 index181 alt1"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">name: </code><code class="java string">"relu1"</code></div><div class="line number183 index182 alt2"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">type: </code><code class="java string">"ReLU"</code></div><div class="line number184 index183 alt1"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">bottom: </code><code class="java string">"ip1"</code></div><div class="line number185 index184 alt2"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">top: </code><code class="java string">"ip1"</code></div><div class="line number186 index185 alt1"><code class="java plain">}</code></div><div class="line number187 index186 alt2"><code class="java preprocessor">/***********************************************************************************************</code></div><div class="line number188 index187 alt1"><code class="java preprocessor">*模块9:</code></div><div class="line number189 index188 alt2"><code class="java preprocessor">*&nbsp;&nbsp;&nbsp;&nbsp; 1--第二个全连接层InnerProduct</code></div><div class="line number190 index189 alt1"><code class="java preprocessor">*&nbsp;&nbsp;&nbsp;&nbsp; 2--该层的输入blob为iP1,输出blob为ip2</code></div><div class="line number191 index190 alt2"><code class="java preprocessor">***********************************************************************************************/</code></div><div class="line number192 index191 alt1"><code class="java plain">layer {</code></div><div class="line number193 index192 alt2"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">name: </code><code class="java string">"ip2"</code></div><div class="line number194 index193 alt1"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">type: </code><code class="java string">"InnerProduct"</code></div><div class="line number195 index194 alt2"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">bottom: </code><code class="java string">"ip1"</code></div><div class="line number196 index195 alt1"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">top: </code><code class="java string">"ip2"</code></div><div class="line number197 index196 alt2"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">param {</code></div><div class="line number198 index197 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">lr_mult: </code><code class="java value">1</code></div><div class="line number199 index198 alt2"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number200 index199 alt1"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">param {</code></div><div class="line number201 index200 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">lr_mult: </code><code class="java value">2</code></div><div class="line number202 index201 alt1"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number203 index202 alt2"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">inner_product_param {&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="java comments">//[1]全连接层的计算参数</code></div><div class="line number204 index203 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">num_output: </code><code class="java value">10</code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code class="java comments">//[1]该层的输出为10个特征,对应0--9这10类数字</code></div><div class="line number205 index204 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">weight_filler {&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="java comments">//[2]该层在网络初始化的初始化方案为:xavier</code></div><div class="line number206 index205 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">type: </code><code class="java string">"xavier"</code></div><div class="line number207 index206 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number208 index207 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">bias_filler {&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="java comments">//[3]给该层添加偏置项,偏置项网络的初始化方案为:constant</code></div><div class="line number209 index208 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">type: </code><code class="java string">"constant"</code></div><div class="line number210 index209 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number211 index210 alt2"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number212 index211 alt1"><code class="java plain">}</code></div><div class="line number213 index212 alt2"><code class="java preprocessor">/***********************************************************************************************</code></div><div class="line number214 index213 alt1"><code class="java preprocessor">*模块10:</code></div><div class="line number215 index214 alt2"><code class="java preprocessor">*&nbsp;&nbsp;&nbsp;&nbsp; 1--Accuracy---分类准确率层</code></div><div class="line number216 index215 alt1"><code class="java preprocessor">*&nbsp;&nbsp;&nbsp;&nbsp; 2--Accuracy层的作用:该层用来计算网络输出相对于目标值的准确率</code></div><div class="line number217 index216 alt2"><code class="java preprocessor">*&nbsp;&nbsp;&nbsp;&nbsp; 3--该层的输入blob为iP2和label,输出blob为accuracy</code></div><div class="line number218 index217 alt1"><code class="java preprocessor">*&nbsp;&nbsp;&nbsp;&nbsp; 4--注意:记住该层只在Test(测试)阶段有效,并且,它并不是一个Loss层,所以这次没有BP操作</code></div><div class="line number219 index218 alt2"><code class="java preprocessor">***********************************************************************************************/</code></div><div class="line number220 index219 alt1"><code class="java plain">layer {</code></div><div class="line number221 index220 alt2"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">name: </code><code class="java string">"accuracy"</code></div><div class="line number222 index221 alt1"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">type: </code><code class="java string">"Accuracy"</code></div><div class="line number223 index222 alt2"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">bottom: </code><code class="java string">"ip2"</code></div><div class="line number224 index223 alt1"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">bottom: </code><code class="java string">"label"</code></div><div class="line number225 index224 alt2"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">top: </code><code class="java string">"accuracy"</code></div><div class="line number226 index225 alt1"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">include {</code></div><div class="line number227 index226 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">phase: TEST</code></div><div class="line number228 index227 alt1"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number229 index228 alt2"><code class="java plain">}</code></div><div class="line number230 index229 alt1"><code class="java preprocessor">/***********************************************************************************************</code></div><div class="line number231 index230 alt2"><code class="java preprocessor">*模块11:</code></div><div class="line number232 index231 alt1"><code class="java preprocessor">*&nbsp;&nbsp;&nbsp;&nbsp; 1--Loss层,损失层</code></div><div class="line number233 index232 alt2"><code class="java preprocessor">*&nbsp;&nbsp;&nbsp;&nbsp; 2--层类型:SoftnaxWithLoss---softmax损失层一般用于计算[多分类问题]的损失,在概念上等同于softmax</code></div><div class="line number234 index233 alt1"><code class="java preprocessor">*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 层后面跟一个多变量的logistic回归损失层,但能提供更稳定的梯度</code></div><div class="line number235 index234 alt2"><code class="java preprocessor">***********************************************************************************************/</code></div><div class="line number236 index235 alt1"><code class="java plain">layer {</code></div><div class="line number237 index236 alt2"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">name: </code><code class="java string">"loss"</code></div><div class="line number238 index237 alt1"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">type: </code><code class="java string">"SoftmaxWithLoss"</code></div><div class="line number239 index238 alt2"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">bottom: </code><code class="java string">"ip2"</code></div><div class="line number240 index239 alt1"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">bottom: </code><code class="java string">"label"</code></div><div class="line number241 index240 alt2"><code class="java spaces">&nbsp;&nbsp;</code><code class="java plain">top: </code><code class="java string">"loss"</code></div><div class="line number242 index241 alt1"><code class="java plain">}</code></div></div></td></tr></tbody></table></div></div>

						</dd></dl>

<div style="position: absolute; border: 0px; margin: 0px; padding: 0px; height: 0px; overflow: visible; text-align: left; top: 1092px; left: 22px; width: 630px; display: block;">


</body></html>