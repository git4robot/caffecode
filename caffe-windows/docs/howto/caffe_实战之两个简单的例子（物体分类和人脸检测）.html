<!DOCTYPE html>
<!-- saved from url=(0036)https://www.bbsmax.com/A/gAJGyG1dZR/ -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<title>caffe_实战之两个简单的例子（物体分类和人脸检测）</title>
<link href="./caffe_实战之两个简单的例子（物体分类和人脸检测）_files/prettify.css" type="text/css" rel="stylesheet">
<!-- <meta name="referrer" content="never">
h -->
<style>
 .menu li { float: left; }
</style>
<link rel="stylesheet" type="text/css" href="./caffe_实战之两个简单的例子（物体分类和人脸检测）_files/prettify(1).css">
<link rel="stylesheet" href="./caffe_实战之两个简单的例子（物体分类和人脸检测）_files/style.css">
<link rel="stylesheet" href="./caffe_实战之两个简单的例子（物体分类和人脸检测）_files/fontello.css">
<link rel="stylesheet" href="./caffe_实战之两个简单的例子（物体分类和人脸检测）_files/animation.css">
</head>
<body>
<div id="header" class="navbar navbar-default navbar-fixed-top header-01">
	<div class="container">
		<h1 class="logo">
			<a href="https://www.bbsmax.com/" title="bbsmax">
							<img src="./caffe_实战之两个简单的例子（物体分类和人脸检测）_files/logo.png" alt="bbsmax">
			</a>
		</h1>
				<div role="navigation" class="site-nav  primary-menu">
			<div class="menu-fix-box">
				 <ul id="menu-navigation" class="menu">
<li>首页</li>
<li>Python</li>
<li>Java</li>
<li>PHP</li>
<li>IOS</li>
<li>Andorid</li>
<li>NodeJS</li>
<li>JavaScript</li>
<li>HTML5</li>
</ul>					 			</div>
		</div>
				<!--<div class="right-nav">
				<button class="js-toggle-search"><i class="icon-search"></i></button>
		</div>-->
       
			</div>	
</div>


<div id="page-content">
	<div class="container">
		<div class="row">
			
			<div class="blog-post">
								<!--<div class="posts-top-cjtz clearfix"></div>-->
								<div class="post">
										<div class="post-title">
						<!--<div class="post-entry-categories"><a href="/tag/abc" rel="tag">tag</a><a href="/tag/abc" rel="tag">tag2</a></div>-->
						<h1 class="title">caffe_实战之两个简单的例子（物体分类和人脸检测）</h1>
						<div class="post_icon"> 
															<span class="icon-user-o"> outthinker</span>															
															<span class="icon-clock-1"> 2016-12-22 </span>
															<span class="icon-article-1"> <a href="https://www.bbsmax.com/link/Z0FKR3lHMWRaUg==" target="_blank" rel="noindex,nofollow,oarchive">原文</a> </span>
					</div>
										<div class="post-content">
					
		<p><strong>一、物体分类：</strong></p>
<p>这里使用的是caffe官网中自带的例子，我这里主要是对代码的解释~</p>
<p>首先导入一些必要的库：</p>
<div>
<pre class="prettyprint linenums prettyprinted"><ol class="linenums"><li class="L0"><span class="kwd">import</span><span class="pln"> caffe</span></li></ol></pre>
</div>
<div>
<div>
<pre class="prettyprint linenums prettyprinted"><ol class="linenums"><li class="L0"><span class="kwd">import</span><span class="pln"> numpy </span><span class="kwd">as</span><span class="pln"> np</span></li><li class="L1"><span class="kwd">import</span><span class="pln"> matplotlib</span><span class="pun">.</span><span class="pln">pyplot </span><span class="kwd">as</span><span class="pln"> plt</span></li><li class="L2"><span class="pun">%</span><span class="pln">matplotlib </span><span class="kwd">inline</span></li><li class="L3"><span class="pln">plt</span><span class="pun">.</span><span class="pln">rcParams</span><span class="pun">[</span><span class="str">'figure.figsize'</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="lit">10</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> </span><span class="lit">10</span><span class="pun">)</span><span class="pln"> </span><span class="com">#显示图像的最大范围,使用plt.rcParams['savefig.dpi']得到缺省的dpi值为100，则最大的图片范围为1000*1000</span></li></ol></pre>
<div>
<pre class="prettyprint linenums prettyprinted"><ol class="linenums"><li class="L0"><span class="pln">plt</span><span class="pun">.</span><span class="pln">rcParams</span><span class="pun">[</span><span class="str">'image.interpolation'</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">'nearest'</span><span class="pln"> </span><span class="com">#最近邻差值方式</span></li></ol></pre>
</div>
<pre class="prettyprint linenums prettyprinted"><ol class="linenums"><li class="L0"><span class="pln">plt</span><span class="pun">.</span><span class="pln">rcParams</span><span class="pun">[</span><span class="str">'image.cmap'</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">'gray'</span><span class="pln"> </span><span class="com">#灰度空间，表明显示图像时是灰度图而不是彩色图 import sys caffe_root = 'E:\\caffe\\caffe-master\\' sys.path.insert(0 , caffe_root + 'python')</span></li></ol></pre>
</div>
</div>
<div>
<pre class="prettyprint linenums prettyprinted"><ol class="linenums"><li class="L0"><span class="kwd">import</span><span class="pln"> os</span></li></ol></pre>
</div>
<div>
<pre class="prettyprint linenums prettyprinted"><ol class="linenums"><li class="L0"><span class="pln">caffe</span><span class="pun">.</span><span class="pln">set_mode_cpu</span><span class="pun">()</span><span class="pln"> </span><span class="com">#CPU模式</span></li></ol></pre>
</div>
<div>
<pre class="prettyprint linenums prettyprinted"><ol class="linenums"><li class="L0"><span class="pln">model_def </span><span class="pun">=</span><span class="pln"> caffe_root </span><span class="pun">+</span><span class="pln"> </span><span class="str">'models/bvlc_reference_caffenet/deploy.prototxt'</span><span class="pln"> </span><span class="com">#加载配置文件</span></li><li class="L1"><span class="pln">model_weights </span><span class="pun">=</span><span class="pln"> caffe_root </span><span class="pun">+</span><span class="pln"> </span><span class="str">'models/bvlc_reference_caffenet/bvlc_reference_caffenet.caffemodel'</span><span class="pln"> </span><span class="com">#加载模型文件</span></li><li class="L2"><span class="pln">net </span><span class="pun">=</span><span class="pln"> caffe</span><span class="pun">.</span><span class="typ">Net</span><span class="pun">(</span><span class="pln">model_def </span><span class="pun">,</span><span class="pln"> model_weights </span><span class="pun">,</span><span class="pln"> caffe</span><span class="pun">.</span><span class="pln">TEST</span><span class="pun">)</span><span class="pln"> </span><span class="com">#用caffe的测试模式，即只是提取特征，不训练</span></li></ol></pre>
</div>
<div>
<pre class="prettyprint linenums prettyprinted"><ol class="linenums"><li class="L0"><span class="com">#预处理函数</span></li><li class="L1"><span class="com">#caffe中用的图像是BGR空间，但是matplotlib用的是RGB空间；再比如caffe的数值空间是[0,255]，但是matplotlib的空间是[0,1]，这些都需要转换</span></li><li class="L2"><span class="com">#载入imagenet的均值，实际图像要减去这个均值，从而减少噪声影响（同时还有特征缩放的作用？）</span></li><li class="L3"><span class="pln">mu </span><span class="pun">=</span><span class="pln"> np</span><span class="pun">.</span><span class="pln">load</span><span class="pun">(</span><span class="pln">caffe_root </span><span class="pun">+</span><span class="pln"> </span><span class="str">'python/caffe/imagenet/ilsvrc_2012_mean.npy'</span><span class="pun">)</span></li><li class="L4"><span class="pln">mu </span><span class="pun">=</span><span class="pln"> mu</span><span class="pun">.</span><span class="pln">mean</span><span class="pun">(</span><span class="lit">1</span><span class="pun">).</span><span class="pln">mean</span><span class="pun">(</span><span class="lit">1</span><span class="pun">)</span><span class="pln">  </span><span class="com">#计算像素的平均值(mean(1)按每行计算均值)</span></li><li class="L5"><span class="kwd">print</span><span class="pln"> </span><span class="str">'mean-subtracted values:'</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> zip</span><span class="pun">(</span><span class="str">'BGR'</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> mu</span><span class="pun">)</span><span class="pln"> </span><span class="com">#打印B、G、R的平均像素值</span></li></ol></pre>
</div>
<div>
<pre class="prettyprint linenums prettyprinted"><ol class="linenums"><li class="L0"><span class="pln">transformer </span><span class="pun">=</span><span class="pln"> caffe</span><span class="pun">.</span><span class="pln">io</span><span class="pun">.</span><span class="typ">Transformer</span><span class="pun">({</span><span class="str">'data'</span><span class="pln"> </span><span class="pun">:</span><span class="pln"> net</span><span class="pun">.</span><span class="pln">blobs</span><span class="pun">[</span><span class="str">'data'</span><span class="pun">].</span><span class="pln">data</span><span class="pun">.</span><span class="pln">shape</span><span class="pun">})</span><span class="pln"> </span><span class="com">#用转换函数Transformer函数使transformer得到data层的数据格式</span></li><li class="L1"><span class="pln">transformer</span><span class="pun">.</span><span class="pln">set_transpose</span><span class="pun">(</span><span class="str">'data'</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> </span><span class="pun">(</span><span class="lit">2</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">))</span><span class="pln">  </span><span class="com">#由于python中读取的图片格式为H*W*K，所以需要转换为caffe的格式即K*H*W</span></li><li class="L2"><span class="pln">transformer</span><span class="pun">.</span><span class="pln">set_mean</span><span class="pun">(</span><span class="str">'data'</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> mu</span><span class="pun">)</span><span class="pln"> </span><span class="com">#每个通道都减去平均像素值</span></li><li class="L3"><span class="pln">transformer</span><span class="pun">.</span><span class="pln">set_raw_scale</span><span class="pun">(</span><span class="str">'data'</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> </span><span class="lit">255</span><span class="pun">)</span><span class="pln"> </span><span class="com">#python 中将图片存储为[0,1]，而caffe中将图片存储为[0,255]，而这里是Python空间，所以将[0,1]转换为[0,255]</span></li><li class="L4"><span class="pln">transformer</span><span class="pun">.</span><span class="pln">set_channel_swap</span><span class="pun">(</span><span class="str">'data'</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> </span><span class="pun">(</span><span class="lit">2</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">))</span><span class="pln"> </span><span class="com">#交换RGB空间到BGR空间</span></li></ol></pre>
</div>
<div>
<pre class="prettyprint linenums prettyprinted"><ol class="linenums"><li class="L0"><span class="pln">net</span><span class="pun">.</span><span class="pln">blobs</span><span class="pun">[</span><span class="str">'data'</span><span class="pun">].</span><span class="pln">reshape</span><span class="pun">(</span><span class="lit">50</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> </span><span class="lit">3</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> </span><span class="lit">227</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> </span><span class="lit">227</span><span class="pun">)</span><span class="pln"> </span><span class="com">#batchsize=50,3通道，图像大小为227*227</span></li></ol></pre>
</div>
<div>
<pre class="prettyprint linenums prettyprinted"><ol class="linenums"><li class="L0"><span class="pln">image </span><span class="pun">=</span><span class="pln"> caffe</span><span class="pun">.</span><span class="pln">io</span><span class="pun">.</span><span class="pln">load_image</span><span class="pun">(</span><span class="pln">caffe_root </span><span class="pun">+</span><span class="pln"> </span><span class="str">'examples/images/cat.jpg'</span><span class="pun">)</span></li><li class="L1"><span class="pln">transformed_image </span><span class="pun">=</span><span class="pln"> transformer</span><span class="pun">.</span><span class="pln">preprocess</span><span class="pun">(</span><span class="str">'data'</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> image</span><span class="pun">)</span><span class="pln"> </span><span class="com">#执行上面的图像预处理操作，并将image载入到blob中，和下面语句一起的</span></li><li class="L2"><span class="pln">plt</span><span class="pun">.</span><span class="pln">imshow</span><span class="pun">(</span><span class="pln">image</span><span class="pun">)</span><span class="pln"> </span><span class="com">#显示图片</span></li></ol></pre>
<p><img src="./caffe_实战之两个简单的例子（物体分类和人脸检测）_files/L3Byb3h5L2h0dHAvaW1hZ2VzMjAxNS5jbmJsb2dzLmNvbS9ibG9nLzEwNjI5MTcvMjAxNjEyLzEwNjI5MTctMjAxNjEyMjIxMTMxNTYzMDctMTQ4NTExMDkxMC5wbmc=.jpg"></p>
<pre class="prettyprint linenums prettyprinted"><ol class="linenums"><li class="L0"><span class="pln">&nbsp;</span></li></ol></pre>
</div>
<div>
<pre class="prettyprint linenums prettyprinted"><ol class="linenums"><li class="L0"><span class="pln">net</span><span class="pun">.</span><span class="pln">blobs</span><span class="pun">[</span><span class="str">'data'</span><span class="pun">].</span><span class="pln">data</span><span class="pun">[...]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> transformed_image</span></li></ol></pre>
</div>
<div>
<pre class="prettyprint linenums prettyprinted"><ol class="linenums"><li class="L0"><span class="pln">output </span><span class="pun">=</span><span class="pln"> net</span><span class="pun">.</span><span class="pln">forward</span><span class="pun">()</span><span class="pln"> </span><span class="com">#进行一次前向传播</span></li><li class="L1"><span class="pln">output_prob </span><span class="pun">=</span><span class="pln"> output</span><span class="pun">[</span><span class="str">'prob'</span><span class="pun">][</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="com">#output_prob存储属于每类的概率，['prob'][0]，它是一个一维数组</span></li><li class="L2"><span class="str">'''</span></li><li class="L3"><span class="str">layer {</span></li><li class="L4"><span class="str">  name: "prob"</span></li><li class="L5"><span class="str">  type: "Softmax"</span></li><li class="L6"><span class="str">  bottom: "fc8"</span></li><li class="L7"><span class="str">  top: "prob"</span></li><li class="L8"><span class="str">}</span></li><li class="L9"><span class="str">'''</span></li><li class="L0"><span class="kwd">print</span><span class="pln"> </span><span class="str">'predicted class is:'</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> output_prob</span><span class="pun">.</span><span class="pln">argmax</span><span class="pun">()</span><span class="pln"> </span><span class="com">#最大概率所在的类别</span></li></ol></pre>
</div>
<pre class="prettyprint linenums prettyprinted"><ol class="linenums"><li class="L0"><span class="kwd">out</span><span class="pun">:</span><span class="pln">predicted </span><span class="kwd">class</span><span class="pln"> </span><span class="kwd">is</span><span class="pun">:</span><span class="pln"> </span><span class="lit">281</span></li></ol></pre>
<div>
<pre class="prettyprint linenums prettyprinted"><ol class="linenums"><li class="L0"><span class="pln">labels_file </span><span class="pun">=</span><span class="pln"> caffe_root </span><span class="pun">+</span><span class="pln"> </span><span class="str">'data/ilsvrc12/synset_words.txt'</span></li><li class="L1"><span class="pln">labels </span><span class="pun">=</span><span class="pln"> np</span><span class="pun">.</span><span class="pln">loadtxt</span><span class="pun">(</span><span class="pln">labels_file </span><span class="pun">,</span><span class="pln"> str </span><span class="pun">,</span><span class="pln"> delimiter </span><span class="pun">=</span><span class="pln"> </span><span class="str">'\t'</span><span class="pun">)</span><span class="pln"> </span><span class="com">#一行一行读取到labels中，定界符delimiter是\t</span></li><li class="L2"><span class="kwd">print</span><span class="pln"> </span><span class="str">'output label:'</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> labels</span><span class="pun">[</span><span class="pln">output_prob</span><span class="pun">.</span><span class="pln">argmax</span><span class="pun">()]</span></li></ol></pre>
</div>
<p>out:</p>
<pre class="prettyprint linenums prettyprinted"><ol class="linenums"><li class="L0"><span class="pln">output label</span><span class="pun">:</span><span class="pln"> n02123045 tabby</span><span class="pun">,</span><span class="pln"> tabby cat</span></li></ol></pre>
<div>
<pre class="prettyprint linenums prettyprinted"><ol class="linenums"><li class="L0"><span class="com">#输出概率较大的前5个物体</span></li><li class="L1"><span class="pln">top_inds </span><span class="pun">=</span><span class="pln"> output_prob</span><span class="pun">.</span><span class="pln">argsort</span><span class="pun">()[:</span><span class="pln"> </span><span class="pun">:</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">][:</span><span class="pln"> </span><span class="lit">5</span><span class="pun">]</span><span class="pln"> </span><span class="com">#得到数组值从小到大的索引值后再从右向左进行提取，并取前5个即概率最大的5个物体</span></li><li class="L2"><span class="kwd">print</span><span class="pln"> </span><span class="str">'probabilities and labels:'</span></li><li class="L3"><span class="pln">zip</span><span class="pun">(</span><span class="pln">output_prob</span><span class="pun">[</span><span class="pln">top_inds</span><span class="pun">]</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> labels</span><span class="pun">[</span><span class="pln">top_inds</span><span class="pun">])</span></li></ol></pre>
</div>
<p>out:</p>
<div>
<div>
<div>
<div>
<pre class="prettyprint linenums prettyprinted"><ol class="linenums"><li class="L0"><span class="pln">probabilities </span><span class="kwd">and</span><span class="pln"> labels</span><span class="pun">:</span></li></ol></pre>
</div>
</div>
<div>
<div>Out[17]:</div>
<div>
<pre class="prettyprint linenums prettyprinted"><ol class="linenums"><li class="L0"><span class="pun">[(</span><span class="lit">0.3124361</span><span class="pun">,</span><span class="pln"> </span><span class="str">'n02123045 tabby, tabby cat'</span><span class="pun">),</span></li><li class="L1"><span class="pln"> </span><span class="pun">(</span><span class="lit">0.23797169</span><span class="pun">,</span><span class="pln"> </span><span class="str">'n02123159 tiger cat'</span><span class="pun">),</span></li><li class="L2"><span class="pln"> </span><span class="pun">(</span><span class="lit">0.12387215</span><span class="pun">,</span><span class="pln"> </span><span class="str">'n02124075 Egyptian cat'</span><span class="pun">),</span></li><li class="L3"><span class="pln"> </span><span class="pun">(</span><span class="lit">0.10075664</span><span class="pun">,</span><span class="pln"> </span><span class="str">'n02119022 red fox, Vulpes vulpes'</span><span class="pun">),</span></li><li class="L4"><span class="pln"> </span><span class="pun">(</span><span class="lit">0.070956953</span><span class="pun">,</span><span class="pln"> </span><span class="str">'n02127052 lynx, catamount'</span><span class="pun">)]</span></li></ol></pre>
</div>
</div>
</div>
</div>
<div>
<div>
<div>&nbsp;</div>
<div>&nbsp;</div>
<div><strong>二、人脸检测</strong></div>
<div>代码来自一个教程中给的视频，贴出代码和附注~</div>
<div>
<div>
<pre class="prettyprint linenums prettyprinted"><ol class="linenums"><li class="L0"><span class="kwd">import</span><span class="pln"> caffe</span></li></ol></pre>
</div>
<div>
<pre class="prettyprint linenums prettyprinted"><ol class="linenums"><li class="L0"><span class="pun">%</span><span class="pln">matplotlib </span><span class="kwd">inline</span></li><li class="L1"><span class="kwd">import</span><span class="pln"> numpy </span><span class="kwd">as</span><span class="pln"> np</span></li><li class="L2"><span class="kwd">import</span><span class="pln"> matplotlib</span><span class="pun">.</span><span class="pln">pyplot </span><span class="kwd">as</span><span class="pln"> plt</span></li><li class="L3"><span class="kwd">import</span><span class="pln"> matplotlib</span><span class="pun">.</span><span class="pln">cbook </span><span class="kwd">as</span><span class="pln"> cbook</span></li><li class="L4"><span class="com">#import Image</span></li><li class="L5"><span class="kwd">import</span><span class="pln"> sys</span></li><li class="L6"><span class="kwd">import</span><span class="pln"> os</span></li><li class="L7"><span class="kwd">from</span><span class="pln">  math </span><span class="kwd">import</span><span class="pln"> pow</span></li><li class="L8"><span class="kwd">from</span><span class="pln"> PIL </span><span class="kwd">import</span><span class="pln"> </span><span class="typ">Image</span><span class="pun">,</span><span class="pln"> </span><span class="typ">ImageDraw</span><span class="pun">,</span><span class="pln"> </span><span class="typ">ImageFont</span></li><li class="L9"><span class="kwd">import</span><span class="pln"> cv2</span></li><li class="L0"><span class="kwd">import</span><span class="pln"> math</span></li><li class="L1"><span class="kwd">import</span><span class="pln"> random</span></li><li class="L2"><span class="pln">caffe_root </span><span class="pun">=</span><span class="pln"> </span><span class="str">'E:\\caffe\\caffe-master\\'</span></li><li class="L3"><span class="pln">&nbsp;</span></li><li class="L4"><span class="pln">sys</span><span class="pun">.</span><span class="pln">path</span><span class="pun">.</span><span class="pln">insert</span><span class="pun">(</span><span class="lit">0</span><span class="pun">,</span><span class="pln"> caffe_root </span><span class="pun">+</span><span class="pln"> </span><span class="str">'python'</span><span class="pun">)</span></li><li class="L5"><span class="pln">os</span><span class="pun">.</span><span class="pln">environ</span><span class="pun">[</span><span class="str">'GLOG_minloglevel'</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">'2'</span></li><li class="L6"><span class="pln">&nbsp;</span></li><li class="L7"><span class="pln">caffe</span><span class="pun">.</span><span class="pln">set_mode_cpu</span><span class="pun">()</span></li></ol></pre>
</div>
<div>
<pre class="prettyprint linenums prettyprinted"><ol class="linenums"><li class="L0"><span class="com">#非极大值抑制算法NMS</span></li><li class="L1"><span class="kwd">class</span><span class="pln"> </span><span class="typ">Point</span><span class="pun">(</span><span class="kwd">object</span><span class="pun">):</span></li><li class="L2"><span class="pln">    </span><span class="kwd">def</span><span class="pln"> __init__</span><span class="pun">(</span><span class="kwd">self</span><span class="pun">,</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> y</span><span class="pun">):</span></li><li class="L3"><span class="pln">        </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">x </span><span class="pun">=</span><span class="pln"> x</span></li><li class="L4"><span class="pln">        </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">y </span><span class="pun">=</span><span class="pln"> y</span></li><li class="L5"><span class="kwd">def</span><span class="pln"> calculateDistance</span><span class="pun">(</span><span class="pln">x1</span><span class="pun">,</span><span class="pln">y1</span><span class="pun">,</span><span class="pln">x2</span><span class="pun">,</span><span class="pln">y2</span><span class="pun">):</span><span class="pln">  </span><span class="com">#计算人脸框的对角线距离</span></li><li class="L6"><span class="pln">    dist </span><span class="pun">=</span><span class="pln"> math</span><span class="pun">.</span><span class="pln">sqrt</span><span class="pun">((</span><span class="pln">x2 </span><span class="pun">-</span><span class="pln"> x1</span><span class="pun">)**</span><span class="lit">2</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="pln">y2 </span><span class="pun">-</span><span class="pln"> y1</span><span class="pun">)**</span><span class="lit">2</span><span class="pun">)</span></li><li class="L7"><span class="pln">    </span><span class="kwd">return</span><span class="pln"> dist</span></li><li class="L8"><span class="pln">&nbsp;</span></li><li class="L9"><span class="kwd">def</span><span class="pln"> range_overlap</span><span class="pun">(</span><span class="pln">a_min</span><span class="pun">,</span><span class="pln"> a_max</span><span class="pun">,</span><span class="pln"> b_min</span><span class="pun">,</span><span class="pln"> b_max</span><span class="pun">):</span></li><li class="L0"><span class="pln">&nbsp;</span></li><li class="L1"><span class="pln">    </span><span class="kwd">return</span><span class="pln"> </span><span class="pun">(</span><span class="pln">a_min </span><span class="pun">&lt;=</span><span class="pln"> b_max</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">and</span><span class="pln"> </span><span class="pun">(</span><span class="pln">b_min </span><span class="pun">&lt;=</span><span class="pln"> a_max</span><span class="pun">)</span></li><li class="L2"><span class="pln">&nbsp;</span></li><li class="L3"><span class="kwd">def</span><span class="pln"> rect_overlaps</span><span class="pun">(</span><span class="pln">r1</span><span class="pun">,</span><span class="pln">r2</span><span class="pun">):</span></li><li class="L4"><span class="pln">    </span><span class="kwd">return</span><span class="pln"> range_overlap</span><span class="pun">(</span><span class="pln">r1</span><span class="pun">.</span><span class="pln">left</span><span class="pun">,</span><span class="pln"> r1</span><span class="pun">.</span><span class="pln">right</span><span class="pun">,</span><span class="pln"> r2</span><span class="pun">.</span><span class="pln">left</span><span class="pun">,</span><span class="pln"> r2</span><span class="pun">.</span><span class="pln">right</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">and</span><span class="pln"> range_overlap</span><span class="pun">(</span><span class="pln">r1</span><span class="pun">.</span><span class="pln">bottom</span><span class="pun">,</span><span class="pln"> r1</span><span class="pun">.</span><span class="pln">top</span><span class="pun">,</span><span class="pln"> r2</span><span class="pun">.</span><span class="pln">bottom</span><span class="pun">,</span><span class="pln"> r2</span><span class="pun">.</span><span class="pln">top</span><span class="pun">)</span></li><li class="L5"><span class="pln">&nbsp;</span></li><li class="L6"><span class="kwd">def</span><span class="pln"> rect_merge</span><span class="pun">(</span><span class="pln">r1</span><span class="pun">,</span><span class="pln">r2</span><span class="pun">,</span><span class="pln"> mergeThresh</span><span class="pun">):</span></li><li class="L7"><span class="pln">&nbsp;</span></li><li class="L8"><span class="pln">    </span><span class="kwd">if</span><span class="pln"> rect_overlaps</span><span class="pun">(</span><span class="pln">r1</span><span class="pun">,</span><span class="pln">r2</span><span class="pun">):</span></li><li class="L9"><span class="pln">        </span><span class="com"># dist = calculateDistance((r1.left + r1.right)/2, (r1.top + r1.bottom)/2, (r2.left + r2.right)/2, (r2.top + r2.bottom)/2)</span></li><li class="L0"><span class="pln">        SI</span><span class="pun">=</span><span class="pln"> abs</span><span class="pun">(</span><span class="pln">min</span><span class="pun">(</span><span class="pln">r1</span><span class="pun">.</span><span class="pln">right</span><span class="pun">,</span><span class="pln"> r2</span><span class="pun">.</span><span class="pln">right</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> max</span><span class="pun">(</span><span class="pln">r1</span><span class="pun">.</span><span class="pln">left</span><span class="pun">,</span><span class="pln"> r2</span><span class="pun">.</span><span class="pln">left</span><span class="pun">))</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> abs</span><span class="pun">(</span><span class="pln">max</span><span class="pun">(</span><span class="pln">r1</span><span class="pun">.</span><span class="pln">bottom</span><span class="pun">,</span><span class="pln"> r2</span><span class="pun">.</span><span class="pln">bottom</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> min</span><span class="pun">(</span><span class="pln">r1</span><span class="pun">.</span><span class="pln">top</span><span class="pun">,</span><span class="pln"> r2</span><span class="pun">.</span><span class="pln">top</span><span class="pun">))</span></li><li class="L1"><span class="pln">        SA </span><span class="pun">=</span><span class="pln"> abs</span><span class="pun">(</span><span class="pln">r1</span><span class="pun">.</span><span class="pln">right </span><span class="pun">-</span><span class="pln"> r1</span><span class="pun">.</span><span class="pln">left</span><span class="pun">)*</span><span class="pln">abs</span><span class="pun">(</span><span class="pln">r1</span><span class="pun">.</span><span class="pln">bottom </span><span class="pun">-</span><span class="pln"> r1</span><span class="pun">.</span><span class="pln">top</span><span class="pun">)</span></li><li class="L2"><span class="pln">        SB </span><span class="pun">=</span><span class="pln"> abs</span><span class="pun">(</span><span class="pln">r2</span><span class="pun">.</span><span class="pln">right </span><span class="pun">-</span><span class="pln"> r2</span><span class="pun">.</span><span class="pln">left</span><span class="pun">)*</span><span class="pln">abs</span><span class="pun">(</span><span class="pln">r2</span><span class="pun">.</span><span class="pln">bottom </span><span class="pun">-</span><span class="pln"> r2</span><span class="pun">.</span><span class="pln">top</span><span class="pun">)</span></li><li class="L3"><span class="pln">        S</span><span class="pun">=</span><span class="pln">SA</span><span class="pun">+</span><span class="pln">SB</span><span class="pun">-</span><span class="pln">SI</span></li><li class="L4"><span class="pln">        ratio </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">float</span><span class="pun">(</span><span class="pln">SI</span><span class="pun">)</span><span class="pln"> </span><span class="pun">/</span><span class="pln"> </span><span class="kwd">float</span><span class="pun">(</span><span class="pln">S</span><span class="pun">)</span></li><li class="L5"><span class="pln">        </span><span class="kwd">if</span><span class="pln"> ratio </span><span class="pun">&gt;</span><span class="pln"> mergeThresh </span><span class="pun">:</span></li><li class="L6"><span class="pln">            </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">1</span></li><li class="L7"><span class="pln">    </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span></li><li class="L8"><span class="kwd">class</span><span class="pln"> </span><span class="typ">Rect</span><span class="pun">(</span><span class="kwd">object</span><span class="pun">):</span></li><li class="L9"><span class="pln">    </span><span class="kwd">def</span><span class="pln"> __init__</span><span class="pun">(</span><span class="kwd">self</span><span class="pun">,</span><span class="pln"> p1</span><span class="pun">,</span><span class="pln"> p2</span><span class="pun">):</span><span class="pln"> </span><span class="com">#p1和p2为对角线上的两个点</span></li><li class="L0"><span class="pln">        </span><span class="str">'''Store the top, bottom, left and right values for points</span></li><li class="L1"><span class="str">               p1 and p2 are the (corners) in either order</span></li><li class="L2"><span class="str">        '''</span></li><li class="L3"><span class="pln">        </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">left   </span><span class="pun">=</span><span class="pln"> min</span><span class="pun">(</span><span class="pln">p1</span><span class="pun">.</span><span class="pln">x</span><span class="pun">,</span><span class="pln"> p2</span><span class="pun">.</span><span class="pln">x</span><span class="pun">)</span><span class="pln"> </span><span class="com">#?????</span></li><li class="L4"><span class="pln">        </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">right  </span><span class="pun">=</span><span class="pln"> max</span><span class="pun">(</span><span class="pln">p1</span><span class="pun">.</span><span class="pln">x</span><span class="pun">,</span><span class="pln"> p2</span><span class="pun">.</span><span class="pln">x</span><span class="pun">)</span></li><li class="L5"><span class="pln">        </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">bottom </span><span class="pun">=</span><span class="pln"> min</span><span class="pun">(</span><span class="pln">p1</span><span class="pun">.</span><span class="pln">y</span><span class="pun">,</span><span class="pln"> p2</span><span class="pun">.</span><span class="pln">y</span><span class="pun">)</span></li><li class="L6"><span class="pln">        </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">top    </span><span class="pun">=</span><span class="pln"> max</span><span class="pun">(</span><span class="pln">p1</span><span class="pun">.</span><span class="pln">y</span><span class="pun">,</span><span class="pln"> p2</span><span class="pun">.</span><span class="pln">y</span><span class="pun">)</span></li><li class="L7"><span class="pln">&nbsp;</span></li><li class="L8"><span class="pln">    </span><span class="kwd">def</span><span class="pln"> __str__</span><span class="pun">(</span><span class="kwd">self</span><span class="pun">):</span></li><li class="L9"><span class="pln">        </span><span class="kwd">return</span><span class="pln"> </span><span class="str">"Rect[%d, %d, %d, %d]"</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> </span><span class="pun">(</span><span class="pln"> </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">left</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">top</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">right</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">bottom </span><span class="pun">)</span></li><li class="L0"><span class="kwd">def</span><span class="pln"> nms_average</span><span class="pun">(</span><span class="pln">boxes</span><span class="pun">,</span><span class="pln"> groupThresh</span><span class="pun">=</span><span class="lit">2</span><span class="pun">,</span><span class="pln"> overlapThresh</span><span class="pun">=</span><span class="lit">0.2</span><span class="pun">):</span></li><li class="L1"><span class="pln">    rects </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[]</span></li><li class="L2"><span class="pln">    temp_boxes </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[]</span></li><li class="L3"><span class="pln">    weightslist </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[]</span></li><li class="L4"><span class="pln">    new_rects </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[]</span></li><li class="L5"><span class="pln">    </span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">len</span><span class="pun">(</span><span class="pln">boxes</span><span class="pun">)):</span></li><li class="L6"><span class="pln">        </span><span class="kwd">if</span><span class="pln"> boxes</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="lit">4</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0.2</span><span class="pun">:</span></li><li class="L7"><span class="pln">            rects</span><span class="pun">.</span><span class="pln">append</span><span class="pun">([</span><span class="pln">boxes</span><span class="pun">[</span><span class="pln">i</span><span class="pun">,</span><span class="lit">0</span><span class="pun">],</span><span class="pln"> boxes</span><span class="pun">[</span><span class="pln">i</span><span class="pun">,</span><span class="lit">1</span><span class="pun">],</span><span class="pln"> boxes</span><span class="pun">[</span><span class="pln">i</span><span class="pun">,</span><span class="lit">2</span><span class="pun">]-</span><span class="pln">boxes</span><span class="pun">[</span><span class="pln">i</span><span class="pun">,</span><span class="lit">0</span><span class="pun">],</span><span class="pln"> boxes</span><span class="pun">[</span><span class="pln">i</span><span class="pun">,</span><span class="lit">3</span><span class="pun">]-</span><span class="pln">boxes</span><span class="pun">[</span><span class="pln">i</span><span class="pun">,</span><span class="lit">1</span><span class="pun">]])</span></li><li class="L8"><span class="pln">&nbsp;</span></li><li class="L9"><span class="pln">    rects</span><span class="pun">,</span><span class="pln"> weights </span><span class="pun">=</span><span class="pln"> cv2</span><span class="pun">.</span><span class="pln">groupRectangles</span><span class="pun">(</span><span class="pln">rects</span><span class="pun">,</span><span class="pln"> groupThresh</span><span class="pun">,</span><span class="pln"> overlapThresh</span><span class="pun">)</span><span class="pln"> </span><span class="com">#函数解释http://blog.csdn.net/nongfu_spring/article/details/38977833</span></li><li class="L0"><span class="pln">&nbsp;</span></li><li class="L1"><span class="pln">    rectangles </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[]</span></li><li class="L2"><span class="pln">    </span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">len</span><span class="pun">(</span><span class="pln">rects</span><span class="pun">)):</span></li><li class="L3"><span class="pln">&nbsp;</span></li><li class="L4"><span class="pln">        testRect </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Rect</span><span class="pun">(</span><span class="pln"> </span><span class="typ">Point</span><span class="pun">(</span><span class="pln">rects</span><span class="pun">[</span><span class="pln">i</span><span class="pun">,</span><span class="lit">0</span><span class="pun">],</span><span class="pln"> rects</span><span class="pun">[</span><span class="pln">i</span><span class="pun">,</span><span class="lit">1</span><span class="pun">]),</span><span class="pln"> </span><span class="typ">Point</span><span class="pun">(</span><span class="pln">rects</span><span class="pun">[</span><span class="pln">i</span><span class="pun">,</span><span class="lit">0</span><span class="pun">]+</span><span class="pln">rects</span><span class="pun">[</span><span class="pln">i</span><span class="pun">,</span><span class="lit">2</span><span class="pun">],</span><span class="pln"> rects</span><span class="pun">[</span><span class="pln">i</span><span class="pun">,</span><span class="lit">1</span><span class="pun">]+</span><span class="pln">rects</span><span class="pun">[</span><span class="pln">i</span><span class="pun">,</span><span class="lit">3</span><span class="pun">]))</span></li><li class="L5"><span class="pln">        rectangles</span><span class="pun">.</span><span class="pln">append</span><span class="pun">(</span><span class="pln">testRect</span><span class="pun">)</span></li><li class="L6"><span class="pln">    clusters </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[]</span></li><li class="L7"><span class="pln">    </span><span class="kwd">for</span><span class="pln"> rect </span><span class="kwd">in</span><span class="pln"> rectangles</span><span class="pun">:</span></li><li class="L8"><span class="pln">        matched </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span></li><li class="L9"><span class="pln">        </span><span class="kwd">for</span><span class="pln"> cluster </span><span class="kwd">in</span><span class="pln"> clusters</span><span class="pun">:</span></li><li class="L0"><span class="pln">            </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">rect_merge</span><span class="pun">(</span><span class="pln"> rect</span><span class="pun">,</span><span class="pln"> cluster </span><span class="pun">,</span><span class="pln"> </span><span class="lit">0.2</span><span class="pun">)</span><span class="pln"> </span><span class="pun">):</span></li><li class="L1"><span class="pln">                matched</span><span class="pun">=</span><span class="lit">1</span></li><li class="L2"><span class="pln">                cluster</span><span class="pun">.</span><span class="pln">left   </span><span class="pun">=</span><span class="pln">  </span><span class="pun">(</span><span class="pln">cluster</span><span class="pun">.</span><span class="pln">left </span><span class="pun">+</span><span class="pln"> rect</span><span class="pun">.</span><span class="pln">left   </span><span class="pun">)/</span><span class="lit">2</span></li><li class="L3"><span class="pln">                cluster</span><span class="pun">.</span><span class="pln">right  </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln"> cluster</span><span class="pun">.</span><span class="pln">right</span><span class="pun">+</span><span class="pln">  rect</span><span class="pun">.</span><span class="pln">right  </span><span class="pun">)/</span><span class="lit">2</span></li><li class="L4"><span class="pln">                cluster</span><span class="pun">.</span><span class="pln">top    </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln"> cluster</span><span class="pun">.</span><span class="pln">top</span><span class="pun">+</span><span class="pln">    rect</span><span class="pun">.</span><span class="pln">top    </span><span class="pun">)/</span><span class="lit">2</span></li><li class="L5"><span class="pln">                cluster</span><span class="pun">.</span><span class="pln">bottom </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln"> cluster</span><span class="pun">.</span><span class="pln">bottom</span><span class="pun">+</span><span class="pln"> rect</span><span class="pun">.</span><span class="pln">bottom </span><span class="pun">)/</span><span class="lit">2</span></li><li class="L6"><span class="pln">&nbsp;</span></li><li class="L7"><span class="pln">        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> matched </span><span class="pun">):</span></li><li class="L8"><span class="pln">            clusters</span><span class="pun">.</span><span class="pln">append</span><span class="pun">(</span><span class="pln"> rect </span><span class="pun">)</span></li><li class="L9"><span class="pln">    result_boxes </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[]</span></li><li class="L0"><span class="pln">    </span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">len</span><span class="pun">(</span><span class="pln">clusters</span><span class="pun">)):</span></li><li class="L1"><span class="pln">&nbsp;</span></li><li class="L2"><span class="pln">        result_boxes</span><span class="pun">.</span><span class="pln">append</span><span class="pun">([</span><span class="pln">clusters</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">left</span><span class="pun">,</span><span class="pln"> clusters</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">bottom</span><span class="pun">,</span><span class="pln"> clusters</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">right</span><span class="pun">,</span><span class="pln"> clusters</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">top</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">])</span></li><li class="L3"><span class="pln">&nbsp;</span></li><li class="L4"><span class="pln">    </span><span class="kwd">return</span><span class="pln"> result_boxes</span></li></ol></pre>
</div>
<div>
<pre class="prettyprint linenums prettyprinted"><ol class="linenums"><li class="L0"><span class="kwd">def</span><span class="pln"> generateBoundingBox</span><span class="pun">(</span><span class="pln">featureMap</span><span class="pun">,</span><span class="pln"> scale</span><span class="pun">):</span><span class="pln"> </span><span class="com">#由于做了scale变换，所以在这里还要将坐标反变换回去</span></li><li class="L1"><span class="pln">    boundingBox </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[]</span><span class="pln"> </span><span class="com">#存储候选框，以及属于人脸的概率</span></li><li class="L2"><span class="pln">    stride </span><span class="pun">=</span><span class="pln"> </span><span class="lit">32</span><span class="pln"> </span><span class="com">#感受野的大小，filter大小,这个需要自己不断地去调整；</span></li><li class="L3"><span class="pln">    cellSize </span><span class="pun">=</span><span class="pln"> </span><span class="lit">227</span><span class="pln"> </span><span class="com">#人脸框的大小，它这里是认为特征图上的一块区域的prob大于95%，就以那个点在原始图像中相应的位置作为人脸框的左上角点，然后框出候选框，但这么做感觉会使候选框变多</span></li><li class="L4"><span class="pln">    </span><span class="com">#遍历最终的特征图，寻找属于人脸的概率大于95%的那些区域，加上Box</span></li><li class="L5"><span class="pln">    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">x</span><span class="pun">,</span><span class="pln">y</span><span class="pun">),</span><span class="pln"> prob </span><span class="kwd">in</span><span class="pln"> np</span><span class="pun">.</span><span class="pln">ndenumerate</span><span class="pun">(</span><span class="pln">featureMap</span><span class="pun">):</span></li><li class="L6"><span class="pln">        </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">prob </span><span class="pun">&gt;=</span><span class="pln"> </span><span class="lit">0.95</span><span class="pun">):</span></li><li class="L7"><span class="pln">            boundingBox</span><span class="pun">.</span><span class="pln">append</span><span class="pun">([</span><span class="kwd">float</span><span class="pun">(</span><span class="pln">stride </span><span class="pun">*</span><span class="pln"> y</span><span class="pun">)/</span><span class="pln"> scale</span><span class="pun">,</span></li><li class="L8"><span class="pln">                                </span><span class="kwd">float</span><span class="pun">(</span><span class="pln">x </span><span class="pun">*</span><span class="pln"> stride</span><span class="pun">)/</span><span class="pln">scale</span><span class="pun">,</span></li><li class="L9"><span class="pln">                                </span><span class="kwd">float</span><span class="pun">(</span><span class="pln">stride </span><span class="pun">*</span><span class="pln"> y </span><span class="pun">+</span><span class="pln"> cellSize </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)/</span><span class="pln">scale</span><span class="pun">,</span></li><li class="L0"><span class="pln">                                </span><span class="kwd">float</span><span class="pun">(</span><span class="pln">stride </span><span class="pun">*</span><span class="pln"> x </span><span class="pun">+</span><span class="pln"> cellSize </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)/</span><span class="pln">scale</span><span class="pun">,</span><span class="pln"> prob</span><span class="pun">])</span></li><li class="L1"><span class="pln">&nbsp;</span></li><li class="L2"><span class="pln">    </span><span class="kwd">return</span><span class="pln"> boundingBox</span></li></ol></pre>
</div>
<div>
<pre class="prettyprint linenums prettyprinted"><ol class="linenums"><li class="L0"><span class="kwd">def</span><span class="pln"> face_detection</span><span class="pun">(</span><span class="pln">imgFile</span><span class="pun">):</span></li><li class="L1"><span class="pln">    net_full_conv </span><span class="pun">=</span><span class="pln"> caffe</span><span class="pun">.</span><span class="typ">Net</span><span class="pun">(</span><span class="pln">os</span><span class="pun">.</span><span class="pln">path</span><span class="pun">.</span><span class="pln">join</span><span class="pun">(</span><span class="pln">caffe_root</span><span class="pun">,</span><span class="pln"> </span><span class="str">'faceDetect'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'deploy_full_conv.prototxt'</span><span class="pun">),</span></li><li class="L2"><span class="pln">                              os</span><span class="pun">.</span><span class="pln">path</span><span class="pun">.</span><span class="pln">join</span><span class="pun">(</span><span class="pln">caffe_root</span><span class="pun">,</span><span class="pln"> </span><span class="str">'faceDetect'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'alexnet_iter_50000_full_conv.caffemodel'</span><span class="pun">),</span></li><li class="L3"><span class="pln">                              caffe</span><span class="pun">.</span><span class="pln">TEST</span><span class="pun">)#全卷积网络(导入训练好的模型和</span><span class="pln">deploy</span><span class="pun">配置文件)</span></li><li class="L4"><span class="pln">    randNum </span><span class="pun">=</span><span class="pln"> random</span><span class="pun">.</span><span class="pln">randint</span><span class="pun">(</span><span class="lit">1</span><span class="pun">,</span><span class="lit">10000</span><span class="pun">)</span><span class="pln"> </span><span class="com">#设置一个在1到10000之间的随机数</span></li><li class="L5"><span class="pln">&nbsp;</span></li><li class="L6"><span class="pln">    scales </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[]</span><span class="pln">  </span><span class="com">#设置几个scale，组成图像金字塔</span></li><li class="L7"><span class="pln">    factor </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0.793700526</span><span class="pln">  </span><span class="com">#图像放大或者缩小的一个因子（经验值）</span></li><li class="L8"><span class="pln">&nbsp;</span></li><li class="L9"><span class="pln">    img </span><span class="pun">=</span><span class="pln"> cv2</span><span class="pun">.</span><span class="pln">imread</span><span class="pun">(</span><span class="pln">imgFile</span><span class="pun">)</span><span class="pln"> </span><span class="com">#读入测试图像</span></li><li class="L0"><span class="pln">&nbsp;</span></li><li class="L1"><span class="pln">    largest </span><span class="pun">=</span><span class="pln"> min</span><span class="pun">(</span><span class="lit">2</span><span class="pun">,</span><span class="pln"> </span><span class="lit">4000</span><span class="pun">/</span><span class="pln">max</span><span class="pun">(</span><span class="pln">img</span><span class="pun">.</span><span class="pln">shape</span><span class="pun">[</span><span class="lit">0</span><span class="pun">:</span><span class="lit">2</span><span class="pun">]))</span><span class="pln"> </span><span class="com">#设定做scale变幻时最大的scale</span></li><li class="L2"><span class="pln">    scale </span><span class="pun">=</span><span class="pln"> largest</span></li><li class="L3"><span class="pln">    minD </span><span class="pun">=</span><span class="pln"> largest</span><span class="pun">*</span><span class="pln">min</span><span class="pun">(</span><span class="pln">img</span><span class="pun">.</span><span class="pln">shape</span><span class="pun">[</span><span class="lit">0</span><span class="pun">:</span><span class="lit">2</span><span class="pun">])</span><span class="pln"> </span><span class="com">#设定最小的scale</span></li><li class="L4"><span class="pln">    </span><span class="kwd">while</span><span class="pln"> minD </span><span class="pun">&gt;=</span><span class="pln"> </span><span class="lit">227</span><span class="pun">:</span><span class="pln"> </span><span class="com">#只要最小的边做完最大的scale变换后大于227，之前得到的largest就可以作为最大的scale来用，并依此乘上factor，加入到scale列表中</span></li><li class="L5"><span class="pln">        scales</span><span class="pun">.</span><span class="pln">append</span><span class="pun">(</span><span class="pln">scale</span><span class="pun">)</span></li><li class="L6"><span class="pln">        scale </span><span class="pun">*=</span><span class="pln"> factor</span></li><li class="L7"><span class="pln">        minD </span><span class="pun">*=</span><span class="pln"> factor</span></li><li class="L8"><span class="pln">&nbsp;</span></li><li class="L9"><span class="pln">    total_boxes </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[]</span><span class="pln">  </span><span class="com">#存储所有的候选框</span></li><li class="L0"><span class="pln">    </span><span class="com">#进行多尺度的人脸检测</span></li><li class="L1"><span class="pln">    </span><span class="kwd">for</span><span class="pln"> scale </span><span class="kwd">in</span><span class="pln"> scales</span><span class="pun">:</span></li><li class="L2"><span class="pln">&nbsp;</span></li><li class="L3"><span class="pln">        scale_img </span><span class="pun">=</span><span class="pln"> cv2</span><span class="pun">.</span><span class="pln">resize</span><span class="pun">(</span><span class="pln">img</span><span class="pun">,((</span><span class="kwd">int</span><span class="pun">(</span><span class="pln">img</span><span class="pun">.</span><span class="pln">shape</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> scale</span><span class="pun">),</span><span class="pln"> </span><span class="kwd">int</span><span class="pun">(</span><span class="pln">img</span><span class="pun">.</span><span class="pln">shape</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> scale</span><span class="pun">))))</span><span class="pln">  </span><span class="com">#调整图像的长和高</span></li><li class="L4"><span class="pln">        cv2</span><span class="pun">.</span><span class="pln">imwrite</span><span class="pun">(</span><span class="str">'E:\\caffe\\caffe-master\\faceDetect\\scale\\scale_img.jpg'</span><span class="pun">,</span><span class="pln">scale_img</span><span class="pun">)</span><span class="pln"> </span><span class="com">#保存图像</span></li><li class="L5"><span class="pln">        </span><span class="com">#图像预处理</span></li><li class="L6"><span class="pln">        im </span><span class="pun">=</span><span class="pln"> caffe</span><span class="pun">.</span><span class="pln">io</span><span class="pun">.</span><span class="pln">load_image</span><span class="pun">(</span><span class="str">'E:\\caffe\\caffe-master\\faceDetect\\scale\\scale_img.jpg'</span><span class="pun">)</span><span class="pln"> </span><span class="com">#得到的特征值是0到1之间的小数</span></li><li class="L7"><span class="pln">        net_full_conv</span><span class="pun">.</span><span class="pln">blobs</span><span class="pun">[</span><span class="str">'data'</span><span class="pun">].</span><span class="pln">reshape</span><span class="pun">(</span><span class="lit">1</span><span class="pun">,</span><span class="lit">3</span><span class="pun">,</span><span class="pln">scale_img</span><span class="pun">.</span><span class="pln">shape</span><span class="pun">[</span><span class="lit">1</span><span class="pun">],</span><span class="pln">scale_img</span><span class="pun">.</span><span class="pln">shape</span><span class="pun">[</span><span class="lit">0</span><span class="pun">])</span><span class="pln"> </span><span class="com">#blobs['data']指data层，字典用法；同时由于图像大小发生了变化，data层的输入接口也要发生相应的变化</span></li><li class="L8"><span class="pln">        transformer </span><span class="pun">=</span><span class="pln"> caffe</span><span class="pun">.</span><span class="pln">io</span><span class="pun">.</span><span class="typ">Transformer</span><span class="pun">({</span><span class="str">'data'</span><span class="pun">:</span><span class="pln"> net_full_conv</span><span class="pun">.</span><span class="pln">blobs</span><span class="pun">[</span><span class="str">'data'</span><span class="pun">].</span><span class="pln">data</span><span class="pun">.</span><span class="pln">shape</span><span class="pun">})</span><span class="pln"> </span><span class="com">#设定图像的shape格式</span></li><li class="L9"><span class="pln">        transformer</span><span class="pun">.</span><span class="pln">set_mean</span><span class="pun">(</span><span class="str">'data'</span><span class="pun">,</span><span class="pln"> np</span><span class="pun">.</span><span class="pln">load</span><span class="pun">(</span><span class="pln">caffe_root </span><span class="pun">+</span></li><li class="L0"><span class="pln">                                             </span><span class="str">'python\\caffe\\imagenet\\ilsvrc_2012_mean.npy'</span><span class="pun">).</span><span class="pln">mean</span><span class="pun">(</span><span class="lit">1</span><span class="pun">).</span><span class="pln">mean</span><span class="pun">(</span><span class="lit">1</span><span class="pun">))</span><span class="pln"> </span><span class="com">#减去均值操作</span></li><li class="L1"><span class="pln">        transformer</span><span class="pun">.</span><span class="pln">set_transpose</span><span class="pun">(</span><span class="str">'data'</span><span class="pun">,</span><span class="pln"> </span><span class="pun">(</span><span class="lit">2</span><span class="pun">,</span><span class="lit">0</span><span class="pun">,</span><span class="lit">1</span><span class="pun">))</span><span class="pln">  </span><span class="com">#move image channels to outermost dimension</span></li><li class="L2"><span class="pln">        transformer</span><span class="pun">.</span><span class="pln">set_channel_swap</span><span class="pun">(</span><span class="str">'data'</span><span class="pun">,</span><span class="pln"> </span><span class="pun">(</span><span class="lit">2</span><span class="pun">,</span><span class="lit">1</span><span class="pun">,</span><span class="lit">0</span><span class="pun">))</span><span class="pln"> </span><span class="com">#swap channels from RGB to BGR</span></li><li class="L3"><span class="pln">        transformer</span><span class="pun">.</span><span class="pln">set_raw_scale</span><span class="pun">(</span><span class="str">'data'</span><span class="pun">,</span><span class="pln"> </span><span class="lit">255.0</span><span class="pun">)</span><span class="pln"> </span><span class="com">#rescale from [0,1] to [0,255]</span></li><li class="L4"><span class="pln">&nbsp;</span></li><li class="L5"><span class="pln">        </span><span class="kwd">out</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> net_full_conv</span><span class="pun">.</span><span class="pln">forward_all</span><span class="pun">(</span><span class="pln">data</span><span class="pun">=</span><span class="pln">np</span><span class="pun">.</span><span class="pln">asarray</span><span class="pun">([</span><span class="pln">transformer</span><span class="pun">.</span><span class="pln">preprocess</span><span class="pun">(</span><span class="str">'data'</span><span class="pun">,</span><span class="pln"> im</span><span class="pun">)]))</span><span class="pln"> </span><span class="com">#进行一次前向传播，out包括所有经过每一层后的特征图，其中元素为[(x,y),prob]（特征图中的每一个小区域都代表一个概率）</span></li><li class="L6"><span class="pln">&nbsp;</span></li><li class="L7"><span class="pln">        boxes </span><span class="pun">=</span><span class="pln"> generateBoundingBox</span><span class="pun">(</span><span class="kwd">out</span><span class="pun">[</span><span class="str">'prob'</span><span class="pun">][</span><span class="lit">0</span><span class="pun">,</span><span class="lit">1</span><span class="pun">],</span><span class="pln"> scale</span><span class="pun">)</span><span class="pln">  </span><span class="com">#输出两类的可能性，并经过筛选获得候选框</span></li><li class="L8"><span class="pln">        </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">boxes</span><span class="pun">):</span></li><li class="L9"><span class="pln">            total_boxes</span><span class="pun">.</span><span class="pln">extend</span><span class="pun">(</span><span class="pln">boxes</span><span class="pun">)</span><span class="pln">  </span><span class="com">#将每次scale变换后的图片得到的候选框存进total_boxes中</span></li><li class="L0"><span class="pln">&nbsp;</span></li><li class="L1"><span class="pln">    boxes_nms </span><span class="pun">=</span><span class="pln"> np</span><span class="pun">.</span><span class="pln">array</span><span class="pun">(</span><span class="pln">total_boxes</span><span class="pun">)</span></li><li class="L2"><span class="pln">    true_boxes </span><span class="pun">=</span><span class="pln"> nms_average</span><span class="pun">(</span><span class="pln">boxes_nms</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0.2</span><span class="pun">)</span><span class="pln">  </span><span class="com">#利用非极大值算法过滤出人脸概率最大的框</span></li><li class="L3"><span class="pln">    </span><span class="kwd">if</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> true_boxes </span><span class="pun">==</span><span class="pln"> </span><span class="pun">[]:</span></li><li class="L4"><span class="pln">        </span><span class="pun">(</span><span class="pln">x1</span><span class="pun">,</span><span class="pln"> y1</span><span class="pun">,</span><span class="pln"> x2</span><span class="pun">,</span><span class="pln"> y2</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> true_boxes</span><span class="pun">[</span><span class="lit">0</span><span class="pun">][:-</span><span class="lit">1</span><span class="pun">]</span></li><li class="L5"><span class="pln">        </span><span class="kwd">print</span><span class="pln"> </span><span class="pun">(</span><span class="pln">x1</span><span class="pun">,</span><span class="pln"> y1</span><span class="pun">,</span><span class="pln"> x2</span><span class="pun">,</span><span class="pln"> y2</span><span class="pun">)</span></li><li class="L6"><span class="pln">        cv2</span><span class="pun">.</span><span class="pln">rectangle</span><span class="pun">(</span><span class="pln">img</span><span class="pun">,</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pun">(</span><span class="pln">x1</span><span class="pun">),</span><span class="kwd">int</span><span class="pun">(</span><span class="pln">y1</span><span class="pun">)),</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pun">(</span><span class="pln">x2</span><span class="pun">),</span><span class="kwd">int</span><span class="pun">(</span><span class="pln">y2</span><span class="pun">)),</span><span class="pln"> </span><span class="pun">(</span><span class="lit">0</span><span class="pun">,</span><span class="lit">0</span><span class="pun">,</span><span class="lit">255</span><span class="pun">),</span><span class="pln">thickness </span><span class="pun">=</span><span class="pln"> </span><span class="lit">5</span><span class="pun">)</span></li><li class="L7"><span class="pln">        cv2</span><span class="pun">.</span><span class="pln">imwrite</span><span class="pun">(</span><span class="str">'E:\\caffe\\caffe-master\\faceDetect\\scale\\result.jpg'</span><span class="pun">,</span><span class="pln">img</span><span class="pun">)</span></li></ol></pre>
</div>
<div>
<pre class="prettyprint linenums prettyprinted"><ol class="linenums"><li class="L0"><span class="pln">imgFile </span><span class="pun">=</span><span class="pln"> </span><span class="str">'E:\\caffe\\caffe-master\\data\\imageset_2\\tangyudi\\tmp9055.jpg'</span></li><li class="L1"><span class="com">#image_file = cbook.get_sample_data(imgFile)</span></li><li class="L2"><span class="pln">img </span><span class="pun">=</span><span class="pln"> plt</span><span class="pun">.</span><span class="pln">imread</span><span class="pun">(</span><span class="pln">imgFile</span><span class="pun">)</span></li><li class="L3"><span class="pln">plt</span><span class="pun">.</span><span class="pln">imshow</span><span class="pun">(</span><span class="pln">img</span><span class="pun">)</span></li><li class="L4"><span class="pln">plt</span><span class="pun">.</span><span class="pln">show</span><span class="pun">()</span></li><li class="L5"><span class="pln">&nbsp;</span></li><li class="L6"><span class="com">#face_detection(imgFile)</span></li></ol></pre>
<p><img src="./caffe_实战之两个简单的例子（物体分类和人脸检测）_files/L3Byb3h5L2h0dHAvaW1hZ2VzMjAxNS5jbmJsb2dzLmNvbS9ibG9nLzEwNjI5MTcvMjAxNjEyLzEwNjI5MTctMjAxNjEyMjIxMTM1NTQyMTQtMTM1MzYxMzE5NC5wbmc=.jpg"></p>
<pre class="prettyprint linenums prettyprinted"><ol class="linenums"><li class="L0"><span class="pln">&nbsp;</span></li></ol></pre>
</div>
<div>
<pre class="prettyprint linenums prettyprinted"><ol class="linenums"><li class="L0"><span class="pln">face_detection</span><span class="pun">(</span><span class="pln">imgFile</span><span class="pun">)</span></li></ol></pre>
</div>
<p>out:</p>
<pre class="prettyprint linenums prettyprinted"><ol class="linenums"><li class="L0"><span class="pun">(</span><span class="lit">581</span><span class="pun">,</span><span class="pln"> </span><span class="lit">147</span><span class="pun">,</span><span class="pln"> </span><span class="lit">818</span><span class="pun">,</span><span class="pln"> </span><span class="lit">384</span><span class="pun">)</span></li></ol></pre>
<div>
<pre class="prettyprint linenums prettyprinted"><ol class="linenums"><li class="L0"><span class="pln">imgFile </span><span class="pun">=</span><span class="pln"> </span><span class="str">'E:\\caffe\\caffe-master\\faceDetect\\scale\\result.jpg'</span></li><li class="L1"><span class="pln">img </span><span class="pun">=</span><span class="pln"> plt</span><span class="pun">.</span><span class="pln">imread</span><span class="pun">(</span><span class="pln">imgFile</span><span class="pun">)</span></li><li class="L2"><span class="pln">plt</span><span class="pun">.</span><span class="pln">imshow</span><span class="pun">(</span><span class="pln">img</span><span class="pun">)</span></li><li class="L3"><span class="pln">plt</span><span class="pun">.</span><span class="pln">show</span><span class="pun">()</span></li></ol></pre>
<p><img src="./caffe_实战之两个简单的例子（物体分类和人脸检测）_files/L3Byb3h5L2h0dHAvaW1hZ2VzMjAxNS5jbmJsb2dzLmNvbS9ibG9nLzEwNjI5MTcvMjAxNjEyLzEwNjI5MTctMjAxNjEyMjIxMTM2NDMyNjEtMjE4MjcxNjgzLnBuZw==.jpg"></p>
<pre class="prettyprint linenums prettyprinted"><ol class="linenums"><li class="L0"><span class="pln">&nbsp;</span></li></ol></pre>
</div>
<p>　　</p>
</div>
<div>&nbsp;</div>
<div>&nbsp;</div>
</div>
</div>
<p>　</p>
<p>　</p>					<h2><a href="https://www.bbsmax.com/R/gAJGyG1dZR/">caffe_实战之两个简单的例子（物体分类和人脸检测）的更多相关文章</a></h2>	
<ol>
								<li><a href="https://www.bbsmax.com/A/MyJxgP71zn/">Java  多线程编程两个简单的例子</a>
		<p style="color: rgba(0, 0, 0, 0.32);margin-bottom: 8px;">/** * @author gao */ package gao.org; public class RunnableDemo implements Runnable{ @Override publi ...</p>
		</li>
						<li><a href="https://www.bbsmax.com/A/8Bz82kby5x/">用一个简单的例子来理解python高阶函数</a>
		<p style="color: rgba(0, 0, 0, 0.32);margin-bottom: 8px;">============================ 用一个简单的例子来理解python高阶函数 ============================ 最近在用mailx发送邮件, 写法大致如 ...</p>
		</li>
						<li><a href="https://www.bbsmax.com/A/D85449nW5E/">ASP.NET Cookie对象到底是毛啊？（简单小例子）</a>
		<p style="color: rgba(0, 0, 0, 0.32);margin-bottom: 8px;">记得刚接触asp.net的时候,就被几个概念搞的头痛不已,比如Request,Response,Session和Cookie.然后还各种在搜索引擎搜,各种问同事的,但是结果就是自己还是很懵的节奏. 那 ...</p>
		</li>
						<li><a href="https://www.bbsmax.com/A/obzb44xM5E/">C#调用存储过程简单完整例子</a>
		<p style="color: rgba(0, 0, 0, 0.32);margin-bottom: 8px;">CREATE PROC P_TEST@Name VARCHAR(20),@Rowcount INT OUTPUTASBEGIN&nbsp;SELECT * FROM T_Customer WHERE&nbsp;NAME= ...</p>
		</li>
						<li><a href="https://www.bbsmax.com/A/pRdBovYnzn/">为什么C语言在2013年仍然很重要：一个简单的例子</a>
		<p style="color: rgba(0, 0, 0, 0.32);margin-bottom: 8px;">附注:在最初的文章里,我没说明进行模2^64的计算——我当然明白那些不是“正确的”斐波那契数列,其实我不是想分析大数,我只是想探寻编译器产生的代码和计算机体系结构而已. 最近,我一直在开发Dynvm— ...</p>
		</li>
						<li><a href="https://www.bbsmax.com/A/1O5Eppl4J7/">Singleton模式(Singleton创建类型)c#简单的例子</a>
		<p style="color: rgba(0, 0, 0, 0.32);margin-bottom: 8px;">单(Singleton创建模式)c#简单的例子 当需要生成一个实例,可单发模式 样品可以在短短的球员中产生,玩家和测试.单线程例子,如以下: namespace singletonpattern {  ...</p>
		</li>
						<li><a href="https://www.bbsmax.com/A/qVdenPAzPg/">简单的例子了解自定义ViewGroup(一)</a>
		<p style="color: rgba(0, 0, 0, 0.32);margin-bottom: 8px;">在Android中,控件可以分为ViewGroup控件与View控件.自定义View控件,我之前的文章已经说过.这次我们主要说一下自定义ViewGroup控件.ViewGroup是作为父控件可以包含多 ...</p>
		</li>
						<li><a href="https://www.bbsmax.com/A/B0zqbZnJvL/">CSharpGL(1)从最简单的例子开始使用CSharpGL</a>
		<p style="color: rgba(0, 0, 0, 0.32);margin-bottom: 8px;">CSharpGL(1)从最简单的例子开始使用CSharpGL 2016-08-13 由于CSharpGL一直在更新,现在这个教程已经不适用最新的代码了.CSharpGL源码中包含10多个独立的Demo ...</p>
		</li>
						<li><a href="https://www.bbsmax.com/A/A7zgjEXod4/">Spring-Context之一:一个简单的例子</a>
		<p style="color: rgba(0, 0, 0, 0.32);margin-bottom: 8px;">很久之前就想系统的学习和掌握Spring框架,但是拖了很久都没有行动.现在趁着在外出差杂事不多,就花时间来由浅入深的研究下Spring框架.Spring框架这几年来已经发展成为一个巨无霸产品.从最初的 ...</p>
		</li>
		</ol>
	

<h2>随机推荐</h2>	
<ol>
									<li><a href="https://www.bbsmax.com/A/QV5ZeywJyb/">sed教程</a>
			<p style="color: rgba(0, 0, 0, 0.32);margin-bottom: 8px;">http://jl453625978.blog.163.com/blog/static/86041705201171511624868/</p>
			</li>
						<li><a href="https://www.bbsmax.com/A/MyJxV2adnL/">NGUI实现技能CD效果</a>
			<p style="color: rgba(0, 0, 0, 0.32);margin-bottom: 8px;">在NGUI中使用Sprite的遮罩效果可以很轻松的实现技能CD效果. 具体实现步骤: ①新建一个技能图标的Sprite 如图中的Skill001,再在该技能Sprite上添加一个Sprite做遮罩,  ...</p>
			</li>
						<li><a href="https://www.bbsmax.com/A/q4zV2pjzKr/">内置函数dict</a>
			<p style="color: rgba(0, 0, 0, 0.32);margin-bottom: 8px;">本函数是从可迭代对象来创建新字典.比如一个元组组成的列表,或者一个字典对象. 例子: ? 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 #dict() #以键对方式构造字典  ...</p>
			</li>
						<li><a href="https://www.bbsmax.com/A/WpdKq701JV/">android Intent的常用flags</a>
			<p style="color: rgba(0, 0, 0, 0.32);margin-bottom: 8px;">首先,我们常见的由MainActivity跳转到另外一个Main1Acticity的代码: Intent mIntent=new Intent(MainActivity.this, Main1Acti ...</p>
			</li>
						<li><a href="https://www.bbsmax.com/A/pRdBjpgedn/">Flat UI 工具包</a>
			<p style="color: rgba(0, 0, 0, 0.32);margin-bottom: 8px;">Flat UI是一套精美的扁平风格 UI 工具包,基于&nbsp;Twitter Bootstrap&nbsp;实现.这套界面工具包含许多基本的和复杂的 UI&nbsp;部件,例如按钮,输入框,组合按钮,复选框,单选按钮,标签,菜 ...</p>
			</li>
						<li><a href="https://www.bbsmax.com/A/ke5jQyyXJr/">QListWidget</a>
			<p style="color: rgba(0, 0, 0, 0.32);margin-bottom: 8px;">1.失去焦点背景颜色,代码设置全选的时候,背景会是白色,需要设置失去焦点背景颜色.(设置焦点,会出现白转化成设置背景色,效果不好) QPalette p; p.setColor(QPalette::I ...</p>
			</li>
						<li><a href="https://www.bbsmax.com/A/kvJ3Mw4pdg/">161220、使用Spring AOP实现MySQL数据库读写分离案例分析</a>
			<p style="color: rgba(0, 0, 0, 0.32);margin-bottom: 8px;">一.前言 分布式环境下数据库的读写分离策略是解决数据库读写性能瓶颈的一个关键解决方案,更是最大限度了提高了应用中读取 (Read)数据的速度和并发量. 在进行数据库读写分离的时候,我们首先要进行数据库 ...</p>
			</li>
						<li><a href="https://www.bbsmax.com/A/n2d9Z0VwzD/">xfire webServeic 例子</a>
			<p style="color: rgba(0, 0, 0, 0.32);margin-bottom: 8px;">xfire webServeic 例子,参考网上众多例子,自己写得完成了,给大家分享 大家只要按这个目录去建文件就可以了,然后运行,至于其中原理慢慢理会吧 环境:myeclipse 10 +xfire ...</p>
			</li>
						<li><a href="https://www.bbsmax.com/A/E35pLQKL5v/">jsp页面 列表 展示 ajax异步实现</a>
			<p style="color: rgba(0, 0, 0, 0.32);margin-bottom: 8px;">1. 服务端先返回页面基本结构(如message.jsp), &lt;%@ page language="java" contentType="text/html; ch ...</p>
			</li>
						<li><a href="https://www.bbsmax.com/A/lk5awVnZz1/">SQL server 2012</a>
			<p style="color: rgba(0, 0, 0, 0.32);margin-bottom: 8px;">MICROSOFT SQL SERVER 2012 企业核心版激活码序列号: FH666-Y346V-7XFQ3-V69JM-RHW28MICROSOFT SQL SERVER 2012 商业智能版激 ...</p>
			</li>
			</ol>			
							
					</div>

					
					<!--<div class="shareBox  clearfix">

					</div>-->
					<!--<div class="posts-cjtz content-cjtz clearfix"><img src="/images.grace/2865270162.png" alt="" /></div>	-->										<div class="next-prev-posts clearfix">
</div>
						 
				</div>
				
	<div class="clear"></div>

			</div>	</div>
</div>
</div>


<div class="clearfix"></div>
<div id="footer" class="two-s-footer">
	<div class="footer-box">
		<div class="container">
			<div class="row" style="padding-left: 15px;padding-right: 15px;">
			<div class="nav-footer">
				<a href="https://www.bbsmax.com/">Home</a>
				</div>
				<div class="copyright-footer">
					<p>Powered By WordPress</p>
				</div>
							</div>
		</div>
	</div>
</div>
<div style="display:none">
<script src="./caffe_实战之两个简单的例子（物体分类和人脸检测）_files/z_stat.php" language="JavaScript"></script><script src="./caffe_实战之两个简单的例子（物体分类和人脸检测）_files/core.php" charset="utf-8" type="text/javascript"></script><a href="http://www.cnzz.com/stat/website.php?web_id=2328196" target="_blank" title="站长统计">站长统计</a>
</div>


</div></body></html>